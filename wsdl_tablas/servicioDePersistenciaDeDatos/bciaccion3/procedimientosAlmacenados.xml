<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
    
<sqlMap namespace="bciaccion3.procedimientosAlmacenados">

<!-- SECCION CARTERA DE CLIENTES PERSONA -->

    <resultMap id="salidaConsultarCarteraClientesPersona" class="java.util.HashMap">
        <result property="rut"                              javaType="long"     column="rut"     jdbcType="numeric" />
        <result property="digitoVerificador"         javaType="String"   column="dv"      jdbcType="char" />
        <result property="nombre"                       javaType="String"   column="nom"     jdbcType="char" />
        <result property="segmento"                   javaType="String"    column="seg"     jdbcType="char" />
        <result property="totalSaldosVista"         javaType="double"   column="prm_dvn" jdbcType="float" />
        <result property="totalColocacionesBci"  javaType="double"   column="prm_col" jdbcType="float" />
        <result property="cruceSBIF"                  javaType="double"    column="rel_sup" jdbcType="float" />
        <result property="totalDeudaSuper"        javaType="double"   column="deu_sbp" jdbcType="float" />
        <result property="cantidadTotal"             javaType="long"      column="can_tot" jdbcType="numeric" />
        <result property="descRegional"             javaType="String"    column="desc_regional"     jdbcType="char" />
        <result property="descOficina"                javaType="String"    column="desc_oficina"     jdbcType="char" />
        <result property="ejecutivo"                    javaType="String"    column="ejecutivo"     jdbcType="char" />
    </resultMap>      

    <!-- dbo.sp_cns_car_cli_per_jer (@cod_reg char(10), @cod_ofi char(3), @cod_eje char(12), @can_reg int, @rut numeric(8) = 0,@ind_pag int = 1) -->
    <procedure id="consultarCarteraClientesPersona" parameterClass="java.util.HashMap" resultMap="salidaConsultarCarteraClientesPersona">
        {CALL sp_cns_car_cli_per_jer(#regional#, #oficina#, #ejecutivo#, #cantidadRegistros#, #rut#, #indicadorPagina#)}
    </procedure>      

<!-- TERMINO SECCION CARTERA DE CLIENTES PERSONA -->

    <procedure id="consultaClientesMiCartera" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_cli_cartera(#region#, #oficina#, #ejecutivo#, #cantidadRegistros#, #rut#, #indicadorPagina#)}
    </procedure>

    <resultMap id="salidaClientesPorRazonSocial" class="java.util.HashMap">
    	<result property="rut"                              javaType="String"     column="cli_rut"     jdbcType="varchar" />    	
    	<result property="dv"                              javaType="String"     column="cli_dv"     jdbcType="varchar" />
    	<result property="razonSocial"                              javaType="String"     column="cli_raz_soc"     jdbcType="varchar" />
    	<result property="paginas"                              javaType="Integer"     column="cantidad_paginas"     jdbcType="int" />
    </resultMap>
    
    <procedure id="obtenerClientesPorRazonSocial" parameterClass="java.util.HashMap" resultMap="salidaClientesPorRazonSocial">
        {CALL sp_buscaEmpresa(#razonSocial#, #pagina#, #regPorPagina#)}
    </procedure>

    <resultMap id="salidaClientesPorNombre" class="java.util.HashMap">
        <result property="rut"                              javaType="java.lang.String"     column="cli_rut"     jdbcType="varchar" />       
        <result property="dv"                              javaType="java.lang.String"     column="cli_dv"     jdbcType="varchar" />
        <result property="nombre"                              javaType="java.lang.String"     column="cli_nom"     jdbcType="varchar" />
        <result property="paginas"                              javaType="java.lang.Integer"     column="num_pag"     jdbcType="INT" />
    </resultMap>
    
    <procedure id="obtenerClientesPorNombre" parameterClass="java.util.HashMap" resultMap="salidaClientesPorNombre">
        {CALL sp_buscaPersona(#nombre#, #apellidoPaterno#, #apellidoMaterno#, #pagina#, #regPorPagina#)}
    </procedure>

    <resultMap id="getConsultaProcesoPersona" class="java.util.HashMap">
        <result property="codigo"      jdbcType="CHAR" javaType="String" />
        <result property="fecha"       jdbcType="CHAR" javaType="String" />
    </resultMap>
    
    <parameterMap id="setConsultaProcesoPersona" class="java.util.HashMap">
        <parameter property="per_rut"            jdbcType="CHAR" javaType="String" />
    </parameterMap>

    <procedure id="consultaProcesoPersona" parameterMap="setConsultaProcesoPersona" resultMap="getConsultaProcesoPersona">
        {CALL sp_ConsultaProcesoPersona2 (?)}
    </procedure>   
</sqlMap>    

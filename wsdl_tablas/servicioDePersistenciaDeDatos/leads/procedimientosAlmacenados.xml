<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="leads.procedimientosAlmacenados">

  <!-- ========================================================================================== ==
    == insertaSolicitudes
    == ========================================================================================== -->

  <resultMap id="ResultInsertaSolicitudNova" class="java.util.HashMap">
    <result property="codigo"  jdbcType="INTEGER" javaType="java.lang.Integer" />
    <result property="mensaje" jdbcType="VARCHAR" javaType="java.lang.String" />
  </resultMap>

  <procedure id="insertaSolicitudes" resultMap="ResultInsertaSolicitudNova">
     { call INS_CargaLeads(#canal#, 
                           #idProducto#,     
                           #rut#,     
                           #digitoVerificador#,     
                           #codigo#,     
                           #codSucursal#,     
                           #codigo2#,     
                           #codigo3#,     
                           #montoTarjetaCred#,     
                           #montoCuota#,     
                           #diaPago#,     
                           #renta#,     
                           #apellidoPaterno#,     
                           #apellidoMaterno#,     
                           #nombreCliRel#,     
                           #fecNacimiento#,     
                           #tipoVivienda#,     
                           #codigo4#,     
                           #sitLaboral#,     
                           #estadoCivil#,     
                           #tipoActiv#,     
                           #fono#,     
                           #identificador#,     
                           #codEstado#,     
                           #empresa#,     
                           #fonoCelular#,     
                           #direccion#,     
                           #comuna#,     
                           #region#,     
                           #email#,     
                           #nivelEducacion#,     
                           #monto#,     
                           #cantidadCuotas#,     
                           #fechaVencimiento#,     
                           #tasa#,     
                           #sexo#,     
                           #nacionalidad#,     
                           #seguroDesgravamen#,     
                           #seguroIncendio#,     
                           #tipoSeguro#,     
                           #codSeguro#,     
                           #seguroCesantia#) }
  </procedure>

  <resultMap id="ResultInsertaSolicitudTarjetaAprobada" class="java.util.HashMap">
    <result property="numeroComprobante"  jdbcType="String" javaType="java.lang.String" />
  </resultMap>

    <procedure id="insertaSolicitudTarjetaAprobada" resultMap="ResultInsertaSolicitudTarjetaAprobada">
     { call SP_ins_sol_tc_apro(
                           #rut#,     
                           #cupoPs#,     			   
			   #cupoDl#,     			   
                           #direccion#,     			   
                           #region#,     
                           #comuna#,     
                           #horaEntrega#,     			   
                           #celular#,     			   
                           #fonoFijo#,     			   			   
                           #email#,     			   
                           #canal#, 
                           #idProducto#) 
     }
  </procedure>

<!-- ========================================================================================== ==
    == insertarCreditoConsumo
    == ========================================================================================== -->  
  	<parameterMap id="setInsertarCreditoConsumo" class="java.util.HashMap">
		<parameter property="fechaMovimiento"				jdbcType="datetime" javaType="Date" />
		<parameter property="horaMovimiento"				jdbcType="VARCHAR"	javaType="String" />
		<parameter property="montoTotal"					jdbcType="int" 		javaType="int" />
		<parameter property="montoLiquido"					jdbcType="int" 		javaType="int" />
		<parameter property="numeroCuotas"					jdbcType="int" 		javaType="int" />
		<parameter property="valorCuotas"					jdbcType="int" 		javaType="int" />
		<parameter property="fechaPrimerVencimiento"		jdbcType="datetime" javaType="Date" />
		<parameter property="tasaOtorgamiento"				jdbcType="float" 	javaType="Double" />
		<parameter property="impuestoConsiderado"			jdbcType="int" 		javaType="int" />
		<parameter property="gastoNotarial"					jdbcType="int" 		javaType="int" />
		<parameter property="seguroDesgravamen"				jdbcType="int" 		javaType="int" />
		<parameter property="montoSeguroDesgravamen"		jdbcType="int" 		javaType="int" />
		<parameter property="seguroInvalidez"				jdbcType="int" 		javaType="int" />
		<parameter property="montoSeguroInvalidez"			jdbcType="int" 		javaType="int" />
		<parameter property="seguroEnfermedadesGraves"		jdbcType="int" 		javaType="int" />
		<parameter property="montoSeguroEnfermedadesGraves"	jdbcType="int" 		javaType="int" />
		<parameter property="seguroHospitalizacion"			jdbcType="int" 		javaType="int" />
		<parameter property="montoSeguroHospitalizacion"	jdbcType="int" 		javaType="int" />
		<parameter property="seguroCesantia"				jdbcType="int" 		javaType="int" />
		<parameter property="montoSeguroCesantia"			jdbcType="int" 		javaType="int" />
		<parameter property="cuentaPrima"					jdbcType="bigint" 	javaType="long" />
		<parameter property="estadoDeposito"				jdbcType="VARCHAR" 	javaType="String" />
		<parameter property="rutCliente"					jdbcType="VARCHAR" 	javaType="String" />
		<parameter property="numeroOperacion"				jdbcType="VARCHAR"	javaType="String" />
        <parameter property="dvRut"                         jdbcType="VARCHAR"  javaType="String" />
		<parameter property="cae"				            jdbcType="float" 	javaType="Double" />
		<parameter property="ctc"					        jdbcType="int" 		javaType="int" />
        <parameter property="valorCuotasReferencial"		jdbcType="int" 		javaType="int" />
		<parameter property="formaDePago"                   jdbcType="VARCHAR"  javaType="String" />
		<parameter property="mail"                          jdbcType="VARCHAR"  javaType="String" />
	    <parameter property="direccion"                     jdbcType="VARCHAR"  javaType="String" />
        <parameter property="comuna"                        jdbcType="VARCHAR"  javaType="String" />
	    <parameter property="ciudad"                        jdbcType="VARCHAR"  javaType="String" />
		
	</parameterMap>
  	<procedure id="insertarCreditoConsumo" parameterMap="setInsertarCreditoConsumo" resultClass="int">
  	   { call sp_insr_cred(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? ) }
  	</procedure>
  	
  	<!-- Inserta Formulario DPS -->
  	
 	<parameterMap id="setInsertarDPS" class="java.util.HashMap">
		<parameter property="numeroOperacion"					jdbcType="VARCHAR"	javaType="String" />
		<parameter property="diabetes"							jdbcType="int"		javaType="int" />
		<parameter property="cirrosisHepatica"					jdbcType="int" 		javaType="int" />
		<parameter property="transplantes"						jdbcType="int" 		javaType="int" />
		<parameter property="hipertensionArterial"				jdbcType="int" 		javaType="int" />
		<parameter property="accidenteVascularEncefalico"		jdbcType="int" 		javaType="int" />
		<parameter property="paralisisOInvalidez"				jdbcType="int" 		javaType="int" />
		<parameter property="cancer"							jdbcType="int" 		javaType="int" />
		<parameter property="hemorragiaOEmboliaCerebral"		jdbcType="int" 		javaType="int" />
		<parameter property="efisemaOInsuficienciaRespiratoria"	jdbcType="int" 		javaType="int" />
		<parameter property="enfermedadesCoronarias"			jdbcType="int" 		javaType="int" />
		<parameter property="insuficienciaRenalCronica"			jdbcType="int" 		javaType="int" />
		<parameter property="obesidadMorbida"					jdbcType="int" 		javaType="int" />
		<parameter property="otrasEnfermedades"					jdbcType="VARCHAR" 	javaType="String" />
		<parameter property="rutCliente"						jdbcType="VARCHAR" 	javaType="String" />
        <parameter property="dvRut"                             jdbcType="VARCHAR"  javaType="String" />
	</parameterMap>
  <procedure id="insertarDPS" parameterMap="setInsertarDPS" resultClass="int">
     { call sp_insr_dps(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
  </procedure>
    <parameterMap id="setCambiarEstadoOferta" class="java.util.HashMap">
        <parameter property="rutCliente"        jdbcType="VARCHAR"  javaType="String" />
        <parameter property="estadoDeposito"      jdbcType="VARCHAR"  javaType="String" />
        <parameter property="numeroOperacion"   jdbcType="VARCHAR"  javaType="String" />
    </parameterMap>
    <procedure id="cambiarEstadoOferta" parameterMap="setCambiarEstadoOferta" resultClass="int">
     { call sp_cambiar_estado_oferta(?, ?, ?) }
    </procedure>
    
      <procedure id="insertaSolicitudMulticaja" resultMap="ResultInsertaSolicitudNova">
         { call INS_CargaLeads_Multicaja(#Canal#, 
                               #Producto#,     
                               #RutCli#,     
                               #Dv#,     
                               #CodVen#,     
                               #CodSuc#, 
    			       #CodCanalVen#,
                               #Estleads#,     
                               #identificador#,     
                               #celular#) }
      </procedure>
  
 <resultMap id="ResultInsertarSolicitudOfertaATM" class="java.util.HashMap">
    <result property="resultado"  jdbcType="int" javaType="int" />
  </resultMap>

    <procedure id="insertarSolicitudOfertaATM" resultMap="ResultInsertarSolicitudOfertaATM">
     { call sp_ins_vta_atm(#codCanal#,
	                       #codProducto#,
                           #rut#,     
                           #digitoVer#,     			   
			               #codCanalVenta#,     			   
                           #idATM#,     			   
                           #codCampana#,     
                           #montoOferta#,     
                           #apellidoPaterno#,
						   #apellidoMaterno#,
						   #nombres#,
                           #fonoFijo#,
						   #fonoComercial#,
						   #telefonosAdicionales#) 
     }
  </procedure>
  
   <resultMap id="ResultActualizarSolicitudOfertaATM" class="java.util.HashMap">
    <result property="codCampana"  jdbcType="int" javaType="int" />
  </resultMap>

   <procedure id="actualizarSolicitudOfertaATM" resultMap="ResultActualizarSolicitudOfertaATM">
     { call sp_act_vta_atm(#rut#,     
                           #idATM#,     			   
						   #fonoContacto#) 
     }
  </procedure>
  <procedure id="insertaClienteMulticaja" resultMap="ResultInsertaSolicitudNova">
     { call INS_CargaCliente_Multicaja(#rut#,
                           #dv#,
                           #fono#,
						   #id_operador#,
                           #estado#,
						   #mensaje#,
						   #codigo_oferta#,
                           #fecha_oferta#,
                           #monto_oferta#) }
  </procedure>
</sqlMap>

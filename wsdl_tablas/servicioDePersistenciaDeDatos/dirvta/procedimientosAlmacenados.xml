<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
  
<sqlMap namespace="dirvta.procedimientosAlmacenados">

   <!-- llamada a procedimientos almacenados en sybase -->
   <procedure id="grabarAsistente" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_asi(#asi_reu_idn#,#asi_eje_sba#,#asi_eje_idn#,#asi_cod_asi#)}
   </procedure>
   
   <procedure id="grabarCompromisos" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_cmo(#cdi_reu_idn#,#cdi_rbp_idn#,#cdi_asi_idn#,#cdi_neg_tub#,#cdi_cne_sem#,#cdi_pto_per#,#cdi_vne_ape#)}
   </procedure>
   
   <procedure id="actualizarCompromiso" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_mod_cmo(#cdi_idn#,#cdi_reu_idn#,#cdi_asi_idn#,#cdi_neg_tub#,#cdi_cne_sem#,#cdi_pto_per#,#cdi_vne_ape#)}
   </procedure>
   
   <procedure id="grabarHabito" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_hab(#hdi_reu_idn#,#hdi_cli_con#,#hdi_asi_idn#,#hdi_pro_ofr#,#hdi_por_uso#,#hdi_ral_gen#,#hdi_num_vis#,#hdi_cli_ges#,#hdi_pro_ges#,#hdi_pro_ace#,#hdi_opo_cre#,#hdi_val_per#,#hdi_val_pmp#,#hdi_val_v01#,#hdi_val_v02#,#hdi_val_v03#,#hdi_val_v04#,#hdi_val_v05#,#hdi_val_v06#,#hdi_val_v07#,#hdi_val_v08#,#hdi_val_v09#,#hdi_val_v10#,#hdi_val_v11# )}
   </procedure>
   
   <procedure id="actualizarHabito" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_mod_hab(#hdi_idn#,#hdi_reu_idn#,#hdi_asi_idn#,#hdi_cli_con#,#hdi_pro_ofr#,#hdi_por_uso#,#hdi_ral_gen#,#hdi_num_vis#,#hdi_cli_ges#,#hdi_pro_ges#,#hdi_pro_ace#,#hdi_opo_cre#,#hdi_val_per#,#hdi_val_pmp#,#hdi_val_v01#,#hdi_val_v02#,#hdi_val_v03#,#hdi_val_v04#,#hdi_val_v05#,#hdi_val_v06#,#hdi_val_v07#,#hdi_val_v08#,#hdi_val_v09#,#hdi_val_v10#,#hdi_val_v11# )}
   </procedure>
   
   <procedure id="grabarHabitoVisita" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_hab_vis(#hdv_hdi_idn#,#hdv_rut_cli#,#hdv_rut_dv#,#hdv_nom_cli#,#hdv_tip_pla#,#hdv_fec_vis#,#hdv_num_opo#)}
   </procedure>
   
   <procedure id="grabarHabitoOportunidad" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_hab_opr(#hdo_hdv_idn#,#hdo_rbp_idn#,#hdo_mon_opo#,#hdo_tip_ori#,#hdo_tip_est#,#hdo_tip_fue#)}
   </procedure>
   
   <procedure id="eliminarHabitoVisita" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_del_hab_vis(#id_habito#)}
   </procedure>
   
   <procedure id="eliminarHabitoOportunidad" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_del_hab_opr(#id_habito#)}
   </procedure>
   
   <procedure id="grabarLogDeCambios" parameterClass="java.util.HashMap">
        {CALL sp_ins_log_evt(#log_reu_idn#,#log_tip_reu#,#log_eje_idn#,#log_det#,#log_blo#,#log_usu_idn#)}
   </procedure>
   
   <procedure id="grabarPeriodoReunion" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_per_reu(#pre_rpb_idn#,#pre_fec#,#pre_dia_cor#,#pre_dia_tot#,#pre_dia_res#,#pre_dia_sem#,#pre_fec_ini#,#pre_fec_fin#)}
   </procedure>
   
   <procedure id="actualizarPeriodoReunion" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_mod_per_reu(#pre_idn#,#pre_rpb_idn#,#pre_fec#,#pre_dia_cor#,#pre_dia_tot#,#pre_dia_res#,#pre_dia_sem#,#pre_fec_ini#,#pre_fec_fin#)}
   </procedure>

   <procedure id="traerLogPrimerEvento" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_pri_log(#log_reu_idn#,#log_tip_reu#)}
   </procedure>
   
    <procedure id="traerLogUltimoEvento" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_ult_log(#log_reu_idn#,#log_tip_reu#)}
    </procedure>
   
   <procedure id="traerPeriodo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_per_idn(#id_periodo#)}
   </procedure>
   
   <procedure id="traerPeriodoPorFecha" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_per_fec(#fecha#,#reunion#)}
   </procedure>
   
   <procedure id="traerReunionPorIdentificador" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_reu(#fecha#,#tipo_reunion#,#oficina#)}
   </procedure>
   
   <procedure id="traerReunion" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_reu_tip(#fecha#,#id_usuario#,#tipo_reunion#)}
   </procedure>
   
   <procedure id="traerUltimaReunionPorEstado" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_ult_reu(#id_usuario#,#estado#,#tipo_reunion#)}
   </procedure>

   <procedure id="traerPorReunion" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_asi_reu(#reunion#)}
   </procedure>
   
   <procedure id="grabarReunion" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_reu(#reu_pre_idn#,#reu_tre_idn#,#reu_tip_est#,#reu_cod_ofi#,#reu_cod_cem#,#reu_cod_zon#,#reu_cod_eje#)}
   </procedure>
   
   <procedure id="actualizarReunion" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_mod_reu(#reu_idn#,#reu_pre_idn#,#reu_tre_idn#,#reu_tip_est#,#reu_fec_cie#,#reu_cod_ofi#,#reu_cod_cem#,#reu_cod_zon#,#reu_cod_eje#)}
   </procedure>
   
   <procedure id="grabarRiesgo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_rsg(#rie_reu_idn#,#rie_tip_rie#,#rie_asi_idn#,#rie_nom_cli#,#rie_mon_deu#,#rie_fec_pla#,#rie_acc#,#rie_tip_est#)}
   </procedure>
   
   <procedure id="actualizarRiesgo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_mod_rsg(#rie_idn#,#rie_reu_idn#,#rie_tip_rie#,#rie_asi_idn#,#rie_nom_cli#,#rie_mon_deu#,#rie_fec_pla#,#rie_acc#,#rie_tip_est#,#rie_fec_ing#)}
   </procedure>
   
      <procedure id="grabarSeguimiento" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_seg(#seg_reu_idn#,#seg_rbp_idn#,#seg_asi_idn#,#seg_cse_ant#,#seg_vne_san#,#seg_vne_sau#,#seg_vne_ape#,#seg_vne_apu#,#seg_pto_per#)}
   </procedure>
   
   <procedure id="actualizarSeguimiento" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_mod_seg(#seg_idn#,#seg_reu_idn#,#seg_rbp_idn#,#seg_asi_idn#,#seg_cse_ant#,#seg_vne_san#,#seg_vne_sau#,#seg_vne_ape#,#seg_vne_apu#,#seg_pto_per#)}
   </procedure>
   
   <procedure id="grabarTuboDeNegocio" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_tub_neg(#tne_reu_idn#,#tne_rbp_idn#,#tne_asi_idn#,#tne_fec#,#tne_fec_lib#,#tne_rut_cli#,#tne_rut_dv#,#tne_nom_cli#,#tne_tip_ban#,#tne_mon#,#tne_tip_est#,#tne_tip_apo#,#tne_det_req#,#tne_tip_fue#,#tne_num_opo#,#tne_eta#,#tne_ori#)}
   </procedure>
   
   <procedure id="actualizarTuboDeNegocio" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_mod_tub_neg(#tne_idn#,#tne_rdi_idn#,#tne_rbp_idn#,#tne_asi_idn#,#tne_fec#,#tne_fec_lib#,#tne_rut_cli#,#tne_rut_dv#,#tne_nom_cli#,#tne_tip_ban#,#tne_mon#,#tne_tip_est#,#tne_tip_apo#,#tne_det_req#,#tne_tip_fue#,#tne_num_opo#,#tne_eta#,#tne_ori#)}
    </procedure>
   
   <procedure id="eliminarSeguimientoPorReunion" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_del_seg_reu(#id_reunion#)}
   </procedure>
   
   <procedure id="traerInformacionDeReunionDeVentaDiariaDiaAnterior" parameterClass="java.util.HashMap" resultClass="java.util.HashMap"> 
        {CALL sp_cns_vta_ant(#oficina#,#fec_ini#,#fec_fin#)}
   </procedure> 
   
   <procedure id="traerInformacionDeReunionDeVentaDiariaDiaAnteriorOtros" parameterClass="java.util.HashMap" resultClass="java.util.HashMap"> 
        {CALL sp_cns_vta_otr(#oficina#,#fec_ini#,#fec_fin#)}
   </procedure>
   
   <procedure id="traerInformacionDeReunionDeVentaDiariaDiaAnteriorSinEjecutivo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap"> 
     {CALL sp_cns_sin_eje(#oficina#,#fec_ini#,#fec_fin#)}
   </procedure>
   
   <procedure id="traerDireccionamientoSeguimientoPorEjecutivo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap"> 
        {CALL sp_cns_dir_seg(#ejecutivo#, #fec_ini#, #fec_fin#, #reunion#, #subbanca#, #reu_est#)}
   </procedure>
   
   <procedure id="traerTuboDeNegociosPorEjecutivo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_tub_ejc(#ejecutivo#,#fec_ini#,#fec_fin#,#reunion#,#estado#)}
   </procedure>

    <resultMap id="getObtenerInformacionReportes" class="java.util.HashMap">
        <result property="idReporte" column="identificador" jdbcType="INT" javaType="java.lang.Integer"/>
        <result property="fechaGeneracion" column="periodo" jdbcType="DATETIME" javaType="java.util.Date"/>
        <result property="tamanoReporte" column="peso" jdbcType="INT" javaType="java.lang.Integer"/>
        <result property="tipoReporte" column="tipo" jdbcType="CHAR" javaType="String"/>
    </resultMap>
    <parameterMap id="setObtenerInformacionReportes" class="java.util.HashMap">
        <parameter property="fechaInicio" jdbcType="DATETIME" javaType="java.util.Date"/>
        <parameter property="fechaTermino" jdbcType="DATETIME" javaType="java.util.Date" />
    </parameterMap>

    <procedure id="obtenerInformacionReportes"  parameterMap="setObtenerInformacionReportes" resultMap="getObtenerInformacionReportes">
        {CALL sp_cns_tab_reporte(?,?)}
   </procedure>
   
      <!-- Inicio Ritmo de Venta -->
   
    <parameterMap id="setTraerInformacionVentaPeriodo" class="java.util.HashMap">
      <parameter property="oficina"     javaType="java.lang.String"     jdbcType="VARCHAR"/>
      <parameter property="ejecutivo"   javaType="java.lang.String"     jdbcType="VARCHAR"/>
      <parameter property="fecha"       javaType="java.lang.String"     jdbcType="VARCHAR"/>
   </parameterMap>
   
   
    <resultMap id="getTraerInformacionVentaPeriodo" class="java.util.HashMap">
        <result property="cantidad"         column="cantidad"       javaType="java.lang.Integer"  jdbcType="Integer"/>
        <result property="tipoCantidad"     column="tipoCantidad"   javaType="String"  jdbcType="VARCHAR" />
    </resultMap>
   
    <procedure id="ritmoDeventa" parameterMap="setTraerInformacionVentaPeriodo" resultMap="getTraerInformacionVentaPeriodo">
            { CALL sp_cns_rtm_vta_per( ?,?,? ) }
    </procedure>
    
    <!-- Fin Ritmo de Venta -->

</sqlMap>

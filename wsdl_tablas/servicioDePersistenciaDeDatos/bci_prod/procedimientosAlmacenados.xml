<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
	
<sqlMap namespace="bci_prod.procedimientosAlmacenados">	
	
	<resultMap id="archivo" class = "java.util.HashMap">
    	<result property = "codigoDeArchivo"		column = "iCodigoArchivo"/>
	    <result property = "nombreDeArchivo"	    column = "vcNombreArchivo"/>
	    <result property = "codigoDePlantilla"	    column = "iCodigoPlantilla"/>
	    <result property = "fechaDeIngreso"	    	column = "sdFechaIngreso"	javaType="Date"/>
	    <result property = "codigoDeUsuario"		column = "cCodigoUsuarioValida"/>
	    <result property = "fechaDeValidacion"		column = "sdFechaValida"	javaType="Date"/>
	    <result property = "codigoUsuarioEntrega"	column = "cCodigoUsuarioEntrega"/>
	    <result property = "fechaDeEntrega"	       	column = "sdFechaEntrega"	javaType="Date"/>
	    <result property = "periodoArchivo"		   	column = "cPeriodoArchivo"/>
		<result property = "estadoDelArchivo"		column = "cEstadoArchivo"/>
	</resultMap>

	<resultMap id="plantilla" class = "java.util.HashMap">
    	<result property = "codigoDePlantilla"		column = "iCodigoPlantilla"/>
	    <result property = "nombreDePlantilla"	    column = "vcNombrePlantilla"/>
	    <result property = "prefijoDePlantilla"	    column = "cPrefijoPlantilla"/>
	    <result property = "tipoDeArchivo"	    	column = "cTipoArchivo"/>
	</resultMap>


	<procedure id="consultaValidaciones" parameterClass="java.util.HashMap" resultMap="archivo">
        {CALL spConsultaValidaciones(#cCodigoUsuarioValida#)}
    </procedure>

	<procedure id="insertarValidacion" parameterClass="java.util.HashMap">
        {CALL spInsertarValidacion(#vcNombreArchivo#, #iCodigoPlantilla#, #sdFechaIngreso#, #cCodigoUsuarioValida#, #cEstadoArchivo#)}
    </procedure>

	<procedure id="actualizarValidacion" parameterClass="java.util.HashMap">
        {CALL spActualizarRegistroValidacion(#iCodigoArchivo#, #cCodigoUsuarioEntrega#, #sdFechaValida:DATE#, #sdFechaEntrega:DATE#, #cEstadoArchivo#)}
    </procedure>

	<procedure id="consultaPlantillaUsuario" parameterClass="java.util.HashMap" resultMap="plantilla">
        {CALL spConsultaUsuarioPlantilla(#cCodigoUsuarioValida#)}
    </procedure>
	
</sqlMap>	
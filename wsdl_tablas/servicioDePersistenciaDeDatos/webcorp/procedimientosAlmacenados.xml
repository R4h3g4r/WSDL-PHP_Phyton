<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
	
<sqlMap namespace="webcorp.procedimientosAlmacenados">
  	<parameterMap id="setAgregaErrorClaveTDC" class="java.util.HashMap">
  		<parameter property="rut"        jdbcType="VARCHAR"     javaType="String" />
		<parameter property="digitoVerificador"   jdbcType="CHAR"     javaType="String" />
		<parameter property="fechaOperacion"      jdbcType="DATETIME" javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler" />
		<parameter property="tipo"       jdbcType="VARCHAR"     javaType="String" />
		<parameter property="idCliente"           jdbcType="VARCHAR"     javaType="String" />
	</parameterMap>
	<procedure id="agregaErrorClaveTDC" parameterMap="setAgregaErrorClaveTDC" resultClass="int" >
    { CALL sp_add_error_clave_TDC( ?, ?, ?, ?, ?)}
	</procedure>
	
	<parameterMap id="setResetBloqueoClaveTDC" class="java.util.HashMap">
  		<parameter property="rut"        jdbcType="VARCHAR"  javaType="String" />
		<parameter property="digver"     jdbcType="CHAR"     javaType="String" />
	</parameterMap>
	<procedure id="resetBloqueoClaveTDC" parameterMap="setResetBloqueoClaveTDC" resultClass="int" >
    { CALL sp_anula_bloqueo_clave_TDC( ?, ? )}
	</procedure>
	
	<parameterMap id="setIntentosDarseAltaTDC" class="java.util.HashMap">
  		<parameter property="rut"        jdbcType="VARCHAR"  javaType="String" />
		<parameter property="digver"     jdbcType="CHAR"     javaType="String" />
	</parameterMap>
	<resultMap id="getIntentosDarseAltaTDC" class="java.util.HashMap">
		<result property="numReintentos"    column="reintCont"      javaType="integer" />
		<result property="fecUltIntento"    column="fecUltReint"    jdbcType="DATETIME" javaType="java.util.Date"  />
	</resultMap>
	<procedure id="intentosDarseAltaTDC" parameterMap="setIntentosDarseAltaTDC" resultMap="getIntentosDarseAltaTDC">
    { CALL sp_getNumIntentos_clave_TDC( ?, ? )}
	</procedure>
</sqlMap>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="riesgo.procedimientosAlmacenados">

    <resultMap id="getObtenerEventosNoSistemicos" class="java.util.HashMap">
        <result property="idEvento"       column="ter_id"       jdbcType="CHAR"      javaType="String" />
        <result property="idFer"          column="fer_id"       jdbcType="int"       javaType="int" />
        <result property="descripcion"    column="ter_des"      jdbcType="VARCHAR"   javaType="String" />
        <result property="estado"         column="ter_est"      jdbcType="CHAR"      javaType="String" />
        <result property="fuente"         column="tfd_des"      jdbcType="VARCHAR"   javaType="String" />
        <result property="clasificacion"  column="cla_des"      jdbcType="VARCHAR"   javaType="String" />
        <result property="semaforo"       column="cla_smf"      jdbcType="CHAR"      javaType="String" />
        <result property="valor"          column="cfd_id"       jdbcType="CHAR"      javaType="String" />
    </resultMap>
   
    <procedure id="obtenerEventosNoSistemicos" parameterClass="java.util.HashMap" resultMap="getObtenerEventosNoSistemicos">
       { CALL sp_cns_evt_no_sistemicos() }
    </procedure>
    
    <parameterMap id="setObtenerConsultaDeRiesgo" class="java.util.HashMap">
        <parameter property="rut"    jdbcType="CHAR" javaType="String" />
    </parameterMap>
    
    <resultMap id="getObtenerConsultaDeRiesgo" class="java.util.HashMap">
        <result property="indTipoFiltro"            jdbcType="CHAR"      javaType="String" />
        <result property="tipoFiltro"               jdbcType="CHAR"      javaType="String" />
        <result property="subTipoFiltro"            jdbcType="CHAR"      javaType="String" />
    </resultMap>
    
    <procedure id="obtenerConsultaDeRiesgo" parameterMap="setObtenerConsultaDeRiesgo" resultMap="getObtenerConsultaDeRiesgo">
      { CALL sp_consultaRiesgo(?) }
    </procedure>  
    
    <parameterMap id="setObtenerCalificacionHistorica" class="java.util.HashMap">
        <parameter property="idCliente"    jdbcType="CHAR" javaType="String" />
    </parameterMap>
    
    <resultMap id="getObtenerCalificacionHistorica" class="java.util.HashMap">
        <result property="fechaActualiza"            jdbcType="CHAR"      javaType="String" />
        <result property="indicador"                 jdbcType="CHAR"      javaType="String" />
    </resultMap>
    
    <procedure id="obtenerCalificacionHistorica" parameterMap="setObtenerCalificacionHistorica" resultMap="getObtenerCalificacionHistorica">
      { CALL sp_con_cal_his(?) }
    </procedure>

    <parameterMap id="setVisacionContingencia" class="java.util.HashMap">
        <parameter property="rut"    jdbcType="CHAR" javaType="String" />
    </parameterMap>
    
    <resultMap id="getVisacionContingencia" class="java.util.HashMap">
        <result property="rut"    jdbcType="CHAR"      javaType="String" />
        <result property="fechaActualiza"         jdbcType="CHAR"      javaType="String" />
        <result property="periodoRentaLiq"      jdbcType="DATE"      javaType="java.util.Calendar" />
        <result property="periodoRentaVar"      jdbcType="DATE"      javaType="java.util.Calendar" />
        <result property="respuesta1"         jdbcType="CHAR"      javaType="String" />
        <result property="respuesta2"         jdbcType="CHAR"      javaType="String" />
        <result property="respuesta3"         jdbcType="CHAR"      javaType="String" />
    </resultMap>
    
    <procedure id="obtenerVisacionContingencia" parameterMap="setVisacionContingencia" resultMap="getVisacionContingencia">
      { CALL sp_con_fil_ibm(?) }
    </procedure>  
   
   
    <parameterMap id="setGuardarConsultaIndicador" class="java.util.HashMap">
        <parameter property="rut"    jdbcType="CHAR" javaType="String" />
        <parameter property="idEvento"    jdbcType="CHAR" javaType="String" />
                    
</parameterMap>
    
    <procedure id="guardarConsultaIndicador" parameterMap="setGuardarConsultaIndicador">
      { CALL sp_GuardaConsultaIndicador(?,?) }
   </procedure>  
    
    
    
    <parameterMap id="setConsultarEventosRiesgo" class="java.util.HashMap">
        <parameter property="rut"    jdbcType="CHAR" javaType="String" />
    </parameterMap>
    
    <resultMap id="getConsultarEventosRiesgo" class="java.util.HashMap">
        <result property="codigo"         jdbcType="CHAR"      javaType="String" />
        <result property="fecha"          jdbcType="CHAR"      javaType="String" />
    </resultMap>
    
    <procedure id="consultarEventosRiesgo" parameterMap="setConsultarEventosRiesgo" resultMap="getConsultarEventosRiesgo">
      { CALL sp_ConsultaRiesgosPersona(?) }
   </procedure>  
</sqlMap>

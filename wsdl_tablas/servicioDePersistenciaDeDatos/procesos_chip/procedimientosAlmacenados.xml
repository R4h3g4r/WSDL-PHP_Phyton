<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">


<sqlMap namespace="procesos_chip.procedimientosAlmacenados">

	<procedure id="registrarInicioProcesoCHIP" parameterClass="java.util.HashMap">
		{CALL sp_registrar_inicio_chip(
		#rut_cli#
		)}
	</procedure>
	<procedure id="marcarSimulacionProcesoCHIP" parameterClass="java.util.HashMap">
		{CALL sp_marcar_simulacion_telecanal(
		#rut_cli#
		)}
	</procedure>

	<parameterMap id="setSimulacionCHIP" class="java.util.HashMap">	
		<parameter property="sch_rut_cli" jdbcType="int" javaType="Long" />
		<parameter property="sch_dv_cli" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_nom_cli" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_ape_paterno" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_ape_materno" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_fec_nac" jdbcType="DATE" javaType="DATE" />		
		<parameter property="sch_pct_seg_desg" jdbcType="numeric" javaType="double" />
		<parameter property="sch_ind_codeudor" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_fec_nac_codeudor" jdbcType="DATE" javaType="DATE" />
		<parameter property="sch_pct_seg_desg_codeudor" jdbcType="numeric" javaType="double" />				
		<parameter property="sch_ind_cliente_bci" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_des_email" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_num_telefono" jdbcType="int" javaType="int" />
		<parameter property="sch_mto_renta" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_gls_canal_venta" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_canal_venta" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_fec_simulacion" jdbcType="DATETIME" javaType="DATE" />
		<parameter property="sch_mto_valor_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_num_result_filtros" jdbcType="tinyint"	javaType="int" />
		<parameter property="sch_ind_contactar_cli" jdbcType="CHAR"	javaType="String" />		
		<parameter property="sch_gls_inmobiliaria" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_inmobiliaria" jdbcType="VARCHAR" javaType="String" />			
		<parameter property="sch_ind_dfl2" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_gls_tipo_vivienda" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_tipo_vivienda" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_ind_material_adobe" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_gls_antiguedad_vivienda" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_antiguedad_vivienda" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_gls_seg_inc_sis_opc" jdbcType="VARCHAR" javaType="String" />		
		<parameter property="sch_cod_seg_inc_sis_opc" jdbcType="int" javaType="int" />
		<parameter property="sch_gls_region" jdbcType="VARCHAR"	javaType="String" />
		<parameter property="sch_cod_region" jdbcType="tinyint"	javaType="int" />
		<parameter property="sch_gls_ciudad" jdbcType="VARCHAR"	javaType="String" />
		<parameter property="sch_cod_ciudad" jdbcType="int"	javaType="int" />
		<parameter property="sch_gls_comuna" jdbcType="VARCHAR"	javaType="String" />
		<parameter property="sch_cod_comuna" jdbcType="int"	javaType="int" />
		<parameter property="sch_mto_precio_vivienda_uf" jdbcType="NUMERIC"	javaType="double" />	
		<parameter property="sch_mto_subsidio_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_cuota_contado_uf" jdbcType="NUMERIC" javaType="double" />		
		<parameter property="sch_mto_credito_uf" jdbcType="NUMERIC"	javaType="double" />
		<parameter property="sch_pct_financiamiento" jdbcType="NUMERIC"	javaType="double" />
		<parameter property="sch_num_plazo" jdbcType="smallint"	javaType="int" />
		<parameter property="sch_gls_producto" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_producto" jdbcType="smallint" javaType="int" />
		<parameter property="sch_gls_tipo_moneda" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_tipo_moneda" jdbcType="int" javaType="int" />
		<parameter property="sch_num_annos_tasa_fija" jdbcType="smallint" javaType="int" />
		<parameter property="sch_gls_tipo_financiamiento" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_tipo_financiamiento" jdbcType="tinyint" javaType="int" />		
		<parameter property="sch_ind_pac" jdbcType="CHAR" javaType="String" />			
		<parameter property="sch_gls_destino" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_destino" jdbcType="smallint" javaType="int" />
		<parameter property="sch_num_mes_gracia" jdbcType="smallint" javaType="int" />
		<parameter property="sch_num_dia_venc" jdbcType="smallint" javaType="int" />
		<parameter property="sch_gls_mes_exclusion" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_mes_exclusion" jdbcType="tinyint" javaType="int" />
		<parameter property="sch_pct_tasa" jdbcType="NUMERIC" javaType="double" />	
		<parameter property="sch_mto_col_tra1_div_neto_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_col_tra1_div_total_uf" jdbcType="NUMERIC" javaType="double" />		
		<parameter property="sch_mto_col_tra1_div_total" jdbcType="NUMERIC" javaType="double" />	
		<parameter property="sch_mto_col_tra2_div_neto_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_col_tra2_div_total_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_col_tra2_div_total" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ind_tra1_div_neto_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ind_tra1_div_total_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ind_tra1_div_total" jdbcType="NUMERIC" javaType="double" />		
		<parameter property="sch_mto_ind_tra2_div_neto_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ind_tra2_div_total_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ind_tra2_div_total" jdbcType="NUMERIC" javaType="double" />			
		<parameter property="sch_pct_cae_col" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ctc_col" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_pct_cae_ind" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ctc_ind" jdbcType="NUMERIC" javaType="double" />		
		<parameter property="sch_mto_col_seg_inc_sis" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_col_seg_desg" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ind_seg_inc_sis" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_ind_seg_desg" jdbcType="NUMERIC" javaType="double" />			
		<parameter property="sch_pct_costo_fondo" jdbcType="NUMERIC" javaType="double" />		
		<parameter property="sch_pct_spread" jdbcType="NUMERIC"	javaType="double" />		
		<parameter property="sch_ind_seg_ces_invol" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_ind_seg_ces_ds01" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_ind_seg_ces_ds40" jdbcType="CHAR" javaType="String" />				
		<parameter property="sch_ind_seg_ces_doble_prot" jdbcType="CHAR" javaType="String" />		
		<parameter property="sch_mto_tot_prima_seg_sel_uf"	jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_tot_prima_seg_sel" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_gls_seg_desg_indiv" jdbcType="VARCHAR"	javaType="String" />
		<parameter property="sch_cod_seg_desg_indiv" jdbcType="tinyint"	javaType="int" />
		<parameter property="sch_gls_seg_adicional" jdbcType="VARCHAR"	javaType="String" />
		<parameter property="sch_cod_seg_adicional" jdbcType="tinyint"	javaType="int" />
		<parameter property="sch_gls_seg_inc_sis_indiv" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_seg_inc_sis_indiv" jdbcType="tinyint" javaType="Integer" />		
		<parameter property="sch_mto_tasacion" jdbcType="NUMERIC" javaType="double" />		
		<parameter property="sch_mto_estudio_titulos" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_borrador_escritura" jdbcType="NUMERIC"	javaType="double" />			
		<parameter property="sch_mto_notaria" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_impuesto_uf" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_cbr_uf" jdbcType="NUMERIC"	javaType="double" />
		<parameter property="sch_mto_gestoria" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_mto_total_gastos_ope" jdbcType="NUMERIC" javaType="double" />
		<parameter property="sch_cod_ejecutivo" jdbcType="VARCHAR"	javaType="String" />
		<parameter property="sch_gls_canal_cred" jdbcType="VARCHAR" javaType="String" />		
		<parameter property="sch_cod_canal_cred" jdbcType="CHAR" javaType="String" />
		<parameter property="sch_gls_ofic_eje" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_ofic_eje" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_origen_simulacion" jdbcType="CHAR" javaType="String" />		
		<parameter property="sch_cod_proyecto" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_gls_proyecto" jdbcType="VARCHAR" javaType="String" />
		<parameter property="sch_cod_convenio" jdbcType="VARCHAR" javaType="String" />		
	</parameterMap>
	<procedure id="guardarSimulacionProcesoCHIP" parameterMap="setSimulacionCHIP">
		{CALL sp_guardar_ult_simulacion_chip(
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?,?,?,
		?,?,?,?,?,?,?,?
		)}
	</procedure>

	<resultMap id="resultPoseeProcesoCHIPVigente" class="java.util.HashMap">
		<result property="procesoVigente" javaType="String" column="procesoVigente"
			jdbcType="varchar" />
	</resultMap>
	<procedure id="poseeProcesoCHIPVigente" parameterClass="java.util.HashMap"
		resultMap="resultPoseeProcesoCHIPVigente">
		{CALL sp_posee_vigencia_chip(
		#rut_cli#)}
	</procedure>

	<resultMap id="resultTotalSimulacionesCHIP" class="java.util.HashMap">
		<result property="totalSimulaciones" javaType="int"
			column="totalSimulaciones" jdbcType="int" />
	</resultMap>
	<procedure id="consultaTotalSimulacionesCHIP" parameterClass="java.util.HashMap"
		resultMap="resultTotalSimulacionesCHIP">
		{CALL sp_total_simulaciones_chip(
		#rut_cli#)}
	</procedure>
</sqlMap>
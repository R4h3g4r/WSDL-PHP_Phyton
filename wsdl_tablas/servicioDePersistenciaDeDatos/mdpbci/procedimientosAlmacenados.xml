<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="mdpbci.procedimientosAlmacenados">

    <resultMap id="res_trans_lbtr" class = "java.util.HashMap">
        <result property = "codResultado"       column = "result_sw"/>
        <result property = "mensajeRespuesta"   column = "result_msg"/>
    </resultMap>

    <resultMap id="res_cns_mdp" class = "java.util.HashMap">
        <result property = "fechaOperacion"             column = "FECHA DE PAGO" jdbcType="datetime" javaType="Date" />
        <result property = "horaValor"                          column = "HRA REALIZACION"/>
        <result property = "rutOrigen"                          column = "RUT ORDENANTE"/>
        <result property = "nombreOrigen"                   column = "NOMBRE ORDENANTE"/>
        <result property = "monto"                                  column = "MONTO"/>
        <result property = "bancoDestino"                   column = "BCO DESTINO"/>
        <result property = "ctacteDestino"                  column = "CTA CTE ORDENANTE"/>
        <result property = "comprobante"                    column = "CANAL"/>
        <result property = "comprobanteComision"    column = "CANAL DESCRIPCION"/>
    </resultMap>

    <resultMap id="res_cns_trf" class = "java.util.HashMap">
        <result property = "nroOperacion"               column = "fld_int_num_ope" jdbcType="int" javaType="int"/>
        <result property = "tipoOperacion"              column = "fld_int_tip_ope" />
        <result property = "fechaOperacion"             column = "fld_int_fec_ope"  jdbcType="datetime" javaType="Date"/>
        <result property = "rutOrigen"              column = "fld_int_rut_ord"/>
        <result property = "dvOrigen"               column = "fld_int_dig_ord" />
        <result property = "nombreOrigen"               column = "fld_int_nom_ord_1" />
        <result property = "direccionOrigen"                column = "fld_int_dir_ord_1" />
        <result property = "telefono"               column = "fld_int_telefono" />
        <result property = "ctacteOrigen"               column = "fld_int_cct_ord" />
        <result property = "monto"              column = "fld_int_mto_ope"/>
        <result property = "fechaValor"             column = "fld_int_fec_val"  jdbcType="datetime" javaType="Date" />
        <result property = "rutDestino"             column = "fld_int_rut_ben" />
        <result property = "dvDestino"              column = "fld_int_dig_ben" />
        <result property = "nombreDestino"              column = "fld_int_nom_ben_1" />
        <result property = "bancoDestino"               column = "fld_int_bco_ben" />
        <result property = "ctacteDestino"              column = "fld_int_cct_ben" />
        <!--<result property = ""                column = "fld_int_moneda" / -->
        <result property = "horaValor"              column = "fld_int_hra_val" />
        <result property = "codProducto"                column = "fld_int_cod_pro" />
        <result property = "comision"               column = "fld_comision" />
        <result property = "comprobante"                column = "fld_comprobante" />
        <result property = "comprobanteComision"                column = "fld_comp_comision" />
        <result property = "estado"             column = "fld_estado" />
        <result property = "usrIngreso"             column = "fld_usr_ingresa" />
        <result property = "ofiUsrIngreso"              column = "fld_usr_ofi_ing" />
        <result property = "usrConfirma"                column = "fld_usr_confirma" />
        <result property = "ofiUsrConfirma"             column = "fld_usr_ofi_conf" />
        <result property = "usrFirma2"              column = "fld_usr_firma2" />
        <result property = "ofiUsrFirma2"               column = "fld_usr_ofi_firma2" />
        <result property = "remesa1"                column = "fld_int_inf_rem_1" />
        <result property = "remesa2"                column = "fld_int_inf_rem_2" />
        <result property = "remesa3"                column = "fld_int_inf_rem_3" />
        <result property = "remesa4"                column = "fld_int_inf_rem_4" />
        <result property = "giro"               column = "fld_giro_comercial"/>
        <result property = "ctacteOrigenComision"               column = "fld_cta_cte_com" />       
    </resultMap>

    <procedure id="ingresarMT103" parameterClass="java.util.HashMap" resultMap="res_trans_lbtr">
        {CALL sp_ing_mt103 (#numOperacion#, #tipoOperacion#, #fechaOperacion#, #rut#, #nombre#, #ctaCargo#, #montoOperacion#, #fechaValorCambio#, #rutBenef#, 
            #nombreBenef#, #bancoBenef#, #ctaAbono#,  #horaTransac#, #idProducto#, #respuesta1#, #respuesta2#, #respuesta3#, #respuesta4#)}
    </procedure>

    <procedure id="consultarTransferencias" parameterClass="java.util.HashMap" resultMap="res_cns_trf">
        {CALL sp_consultaLbtrWcorp (#fechaOperacion#, #fecha2#, #rut#, #rut2#, #estado#)}
    </procedure>

    <procedure id="recuperaBicBanco" parameterClass="java.util.HashMap"  resultClass="java.util.HashMap">
        {CALL sp_con_bic_Bancos (#codBanco#)}
    </procedure>

    <procedure id="confirmarTransferencias" parameterClass="java.util.HashMap" resultMap="res_trans_lbtr">
        {CALL sp_modificaLbtrWcorp (#numOperacion#, #fechaOperacion#, #rut#, #codigo2#, #estado#, #usuario#, #oficina#, #usuarioModif#, #oficinaNormal#, #usuarioModifSol#, #oficinaCargo#)}
    </procedure>

    <procedure id="generaFolio" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_generaSemillaLbtr ()}
    </procedure>

    <procedure id="ingresarTransferencias" parameterClass="java.util.HashMap" resultMap="res_trans_lbtr">
        {CALL sp_ingresaLbtrWcorp (#numOperacion#, #tipoOperacion#, #fechaOperacion#, #rut#, #digitoVerificador#, #nombre#, #direccion#, #fono#, #ctaCargo#, #montoOperacion#, 
            #fechaValorCambio#, #rutBenef#, #digitoVerifBenef#, #nombreBenef#, #bancoBenef#, #ctaAbono#, #moneda#, #horaTransac#, #codigo#, #montoComision#, #codigoCargo#, 
            #codigo2#, #estado#, #usuario#, #oficina#, #usuarioModif#, #oficinaNormal#, #usuarioModifSol#, #oficinaCargo#, #respuesta1#, #respuesta2#, #respuesta3#, #respuesta4#, 
            #estado2#, #comisionCtaCte#)}
    </procedure>

    <procedure id="consultarTransferenciasMDP" parameterClass="java.util.HashMap" resultMap="res_cns_mdp">
        {CALL sp_con_env_cta (#rut#, #fechaOperacion#, #fecha2#)}
    </procedure>

    <parameterMap class="java.util.HashMap" id="setIngresarMT103TodosServicios">
        <parameter property="cod_pro"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="num_ope"    jdbcType="NUMERIC" javaType="java.lang.Integer" mode="IN" />
        <parameter property="tip_ope"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ind_cov"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="fec_ope"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="cod_mon"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="rut_ord"    jdbcType="NUMERIC" javaType="java.lang.Long" mode="IN" />
        <parameter property="suc_ord"    jdbcType="NUMERIC" javaType="java.lang.Integer" mode="IN" />
        <parameter property="nom_ord_1"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="nom_ord_2"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="cct_ord"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="dcv_ord"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="mto_ope"    jdbcType="NUMERIC" javaType="java.lang.Long" mode="IN" />
        <parameter property="fec_val"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="rut_ben"    jdbcType="NUMERIC" javaType="java.lang.Long" mode="IN" />
        <parameter property="suc_ben"    jdbcType="NUMERIC" javaType="java.lang.Integer" mode="IN" />
        <parameter property="dcv_ben"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="nom_ben_1"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="nom_ben_2"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="bco_ben"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="cct_ben"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="inf_rem_1"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="inf_rem_2"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="inf_rem_3"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="inf_rem_4"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="det_gtos"   jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="hra_val"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="num_con"    jdbcType="NUMERIC" javaType="java.lang.Integer" mode="IN" />
        <parameter property="ref_con_1"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_2"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_3"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_4"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_5"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_6"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_7"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_8"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_9"  jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="ref_con_10" jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="for_pag"    jdbcType="CHAR"    javaType="String" mode="IN" />
        <parameter property="result_sw"  jdbcType="INTEGER" javaType="java.lang.Integer" mode="OUT" />
        <parameter property="result_msg" jdbcType="CHAR"    javaType="String" mode="OUT" />
    </parameterMap>

    <procedure id="ingresarMT103TodosServicios" parameterMap="setIngresarMT103TodosServicios" resultClass="java.util.HashMap">
       {CALL MDPsrv_sol_ing_pago_cred(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) }
    </procedure>

  <parameterMap id="setConsultarTrfRecibidas" class="java.util.HashMap">
        <parameter property="rutDestino"    jdbcType="CHAR"          javaType="String"/>
        <parameter property="dechaDesde"    jdbcType="DATETIME"      javaType="String"/>
        <parameter property="fechaHasta"    jdbcType="DATETIME"      javaType="String"/>
        <parameter property="ctaDestino"    jdbcType="CHAR"          javaType="String"/>
        <parameter property="pagina"        jdbcType="TINYINT"       javaType="java.lang.Integer"/>
        <parameter property="cantRegistros" jdbcType="INT"           javaType="java.lang.Integer"/>
    </parameterMap>
    <resultMap id="getConsultarTrfRecibidas" class="java.util.HashMap">    
          <result property="idTransferencia"   jdbcType="CHAR"    javaType="String" />
          <result property="fecha"             jdbcType="DATETIME" javaType="String" />
          <result property="hora"              jdbcType="CHAR"    javaType="String" />
          <result property="rutBenef"          jdbcType="CHAR"    javaType="String" />
          <result property="nombreBenef"       jdbcType="CHAR"    javaType="String" />
          <result property="monto"             jdbcType="CHAR"    javaType="String" />
          <result property="referencia"        jdbcType="CHAR"    javaType="String" />
          <result property="glosa"             jdbcType="CHAR"    javaType="String" />
          <result property="cantidad2"         jdbcType="NUMERIC" javaType="java.lang.Integer"  />
   </resultMap>
<procedure id="consultarTrfRecibidas" parameterMap="setConsultarTrfRecibidas" resultMap="getConsultarTrfRecibidas">
    { CALL sp_cons_trf_rec_alt_mto ( ?,?,?,?,?,?) }
</procedure> 

<parameterMap id="setConsultaNominasSucursalesHistoricas"  class="java.util.HashMap">
        <parameter property="rutEmpresa"              jdbcType="VARCHAR"    javaType="String" />
        <parameter property="cuentaCargo"             jdbcType="VARCHAR"    javaType="String" />
        <parameter property="fechaPagoDesde"          jdbcType="DATETIME"   javaType="String" />
        <parameter property="fechaPagoHasta"          jdbcType="DATETIME"   javaType="String" />
        <parameter property="numeroTransferencia"     jdbcType="VARCHAR"    javaType="String" />
        <parameter property="estado"                  jdbcType="VARCHAR"    javaType="String" />
        <parameter property="montoPagarDesde"         jdbcType="MONEY"      javaType="Double" />
        <parameter property="montoPagarHasta"         jdbcType="MONEY"      javaType="Double" />
        <parameter property="pagina"                  jdbcType="INT"        javaType="Integer" />
        <parameter property="cantRegistros"           jdbcType="INT"        javaType="Integer" />
    </parameterMap>
    <resultMap id="getConsultaNominasSucursalesHistoricas" class="java.util.HashMap">
         <result property="numeroTransferencia"    jdbcType="VARCHAR"       javaType="String"/>
         <result property="rutEmpresa"             jdbcType="VARCHAR"       javaType="String"/> 
         <result property="dvEmpresa"              jdbcType="CHAR"          javaType="String"/>
         <result property="razonSocial"            jdbcType="VARCHAR"       javaType="String"/>
         <result property="cuentaCorriente"        jdbcType="VARCHAR"       javaType="String"/>
         <result property="fechaPago"              jdbcType="DATETIME"      javaType="java.util.Date"/>
         <result property="fechaIngreso"           jdbcType="DATETIME"      javaType="java.util.Date"/>
         <result property="monto"                  jdbcType="NUMERIC"       javaType="Double"/>
         <result property="bancoDestino"           jdbcType="VARCHAR"       javaType="String"/>
         <result property="estado"                 jdbcType="VARCHAR"       javaType="String"/>
         <result property="descripcionEstado"      jdbcType="VARCHAR"       javaType="String"/>
         <result property="cantidadPaginas"        jdbcType="INT"           javaType="Integer"/>
         <result property="cantidadRegistros"      jdbcType="INT"           javaType="Integer"/>
    </resultMap>
    <procedure id="consultaNominasSucursalesHistoricas" parameterMap="setConsultaNominasSucursalesHistoricas" resultMap="getConsultaNominasSucursalesHistoricas">
        {CALL MDP_cns_nom_fil_alt_mto(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
    </procedure>

<parameterMap id="setConsultaPagosDestinatarioBCIPorFiltro" class="java.util.HashMap">
        <parameter property="rutDestinatario"      jdbcType="VARCHAR"  javaType="String" />
        <parameter property="fechaPagoDesde"       jdbcType="DATETIME" javaType="String" />
        <parameter property="fechaPagoHasta"       jdbcType="DATETIME" javaType="String" />
        <parameter property="cuentaDestino"        jdbcType="VARCHAR"  javaType="String" />
        <parameter property="montoPagarDesde"      jdbcType="MONEY"    javaType="Double" />
        <parameter property="montoPagarHasta"      jdbcType="MONEY"    javaType="Double" />
        <parameter property="rutPagador"           jdbcType="VARCHAR"  javaType="String" />
        <parameter property="rutFiltro"            jdbcType="VARCHAR"  javaType="String" />
        <parameter property="pagina"               jdbcType="INT"      javaType="Integer" />
        <parameter property="cantRegistros"        jdbcType="INT"      javaType="Integer" />   
    </parameterMap>
    
    <resultMap id="getConsultaPagosDestinatarioBCIPorFiltro" class="java.util.HashMap">
     	<result  property="codigoTransferencia"         jdbcType="VARCHAR"      javaType="String" />
        <result  property="rutDestinatario"             jdbcType="VARCHAR"      javaType="String" />
        <result  property="cuentaDestinatario"          jdbcType="VARCHAR"      javaType="String" />
        <result  property="rutPagador"                  jdbcType="VARCHAR"      javaType="String" />
        <result  property="bancoPagador"                jdbcType="VARCHAR"      javaType="String" />
        <result  property="nombreBancoPagador"          jdbcType="VARCHAR"      javaType="String" />
        <result  property="nombreBancoDestinatario"     jdbcType="VARCHAR"      javaType="String" />
        <result  property="fechaPago"                   jdbcType="DATETIME"     javaType="Date" />
        <result  property="monto"                       jdbcType="MONEY"        javaType="Double" />
        <result  property="codigoEstado"                jdbcType="VARCHAR"      javaType="String" />
        <result  property="descripcionEstado"           jdbcType="VARCHAR"      javaType="String" />
        <result  property="nombreDestinatario"          jdbcType="VARCHAR"      javaType="String" />
        <result  property="nombrePagador"               jdbcType="VARCHAR"      javaType="String" />
        <result  property="descripcionTipoPago"         jdbcType="VARCHAR"      javaType="String" />
        <result  property="cantidadPaginas"             jdbcType="INT"          javaType="Integer" />
        <result  property="cantidadRegistros"           jdbcType="INT"          javaType="Integer" />
    </resultMap>
    <procedure id="consultaPagosDestinatarioBCIPorFiltro" parameterMap="setConsultaPagosDestinatarioBCIPorFiltro" resultMap="getConsultaPagosDestinatarioBCIPorFiltro">
        {CALL sp_cns_trf_rec_bci_fil ( ?, ?, ?, ?, ?, ?, ?, ?, ?, ? )}
    </procedure>
    
    <parameterMap id="setConsultaPagosDestinatarioBancoPorFiltro" class="java.util.HashMap">
        <parameter  property="fechaPagoDesde"           jdbcType="DATETIME"  javaType="String" />
        <parameter  property="fechaPagoHasta"           jdbcType="DATETIME"  javaType="String" />
        <parameter  property="montoPagarDesde"          jdbcType="MONEY"     javaType="Double" />
        <parameter  property="montoPagarHasta"          jdbcType="MONEY"     javaType="Double" />
        <parameter  property="rutFiltro"                jdbcType="VARCHAR"   javaType="String" />
        <parameter  property="pagina"                   jdbcType="INT"       javaType="Integer" />
        <parameter  property="cantRegistros"            jdbcType="INT"       javaType="Integer" />
    </parameterMap>
    <resultMap id="getConsultaPagosDestinatarioBancoPorFiltro" class="java.util.HashMap">
        <result  property="rutDestinatario"             jdbcType="VARCHAR"      javaType="String" />
        <result  property="cuentaDestinatario"          jdbcType="VARCHAR"      javaType="String" />
        <result  property="rutPagador"                  jdbcType="VARCHAR"      javaType="String" />
        <result  property="bancoPagador"                jdbcType="VARCHAR"      javaType="String" />
        <result  property="nombreBanco"                 jdbcType="VARCHAR"      javaType="String" />
        <result  property="fechaPago"                   jdbcType="DATETIME"     javaType="Date" />
        <result  property="monto"                       jdbcType="MONEY"        javaType="Double" />
        <result  property="codigoEstado"                jdbcType="VARCHAR"      javaType="String" />
        <result  property="descripcionEstado"           jdbcType="VARCHAR"      javaType="String" />
        <result  property="cantidadPaginas"             jdbcType="INT"          javaType="Integer" />
        <result  property="cantidadRegistros"           jdbcType="INT"          javaType="Integer" />
    </resultMap>
    <procedure id="consultaPagosDestinatarioBancoPorFiltro" parameterMap="setConsultaPagosDestinatarioBancoPorFiltro" resultMap="getConsultaPagosDestinatarioBancoPorFiltro">
        {CALL sp_cns_trf_rec_bco_fil ( ?, ?, ?, ?, ?, ?, ?)}
    </procedure>
	
	<resultMap id="getObtenerBancosAutorizados" class="java.util.HashMap">
        <result property="codigoIsoBanco" column="codigo_iso" javaType="String"/>
        <result property="nombreBanco" column="glosa_nombre" javaType="String"/>
        <result property="codigoBanco" column="cod_dcvbco" javaType="String"/>
        <result property="rutBanco" column="cod_rut_banco" javaType="String"/>
        <result property="nombreBancoAbreviado" column="glosa_abrev" javaType="String"/>
    </resultMap>
    <procedure id="obtenerBancosAutorizados" resultMap="getObtenerBancosAutorizados">
        { CALL sp_con_bco_aut() }
    </procedure>
	
</sqlMap>   
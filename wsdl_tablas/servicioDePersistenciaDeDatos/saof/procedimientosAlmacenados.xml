<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
    
<sqlMap namespace="saof.procedimientosAlmacenados">

    <resultMap id="resultObtieneGrupo" class="java.util.HashMap">
        <result property="gpa_codigo_grupo" column="gpa_codigo_grupo" jdbcType="char"    javaType="String" />
        <result property="gpa_descripcion"  column="gpa_descripcion"  jdbcType="varchar" javaType="String" />
    </resultMap>

    <procedure id="obtieneGrupo" parameterClass="java.util.HashMap" resultMap="resultObtieneGrupo">
        {CALL sp_cns_grupo_parametro()}
    </procedure>

    <resultMap id="resultObtieneCodigo" class="java.util.HashMap">
        <result property="cpa_codigo_parametro" column="cpa_codigo_parametro" jdbcType="char" javaType="String"/>
        <result property="cpa_descripcion" column="cpa_descripcion" jdbcType="varchar" javaType="String"/>
    </resultMap>
    
    <parameterMap id="paramObtieneCodigo" class="java.util.HashMap">
        <parameter property="codigo" jdbcType="char" javaType="String" />
    </parameterMap>
    
    <procedure id="obtieneCodigo" parameterMap="paramObtieneCodigo" resultMap="resultObtieneCodigo">
        {CALL sp_cns_codigo_parametro(?)}
    </procedure>
    
    <procedure id="obtenerCodigoDescripcion" parameterClass="java.util.HashMap" resultMap="resultObtieneCodigo">
        {CALL sp_cns_codigoDesc_parametro()}
    </procedure>
    
    <procedure id="insertarParametro" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_parametro(#grupo#,#codigo#,#anno#,#valor#)}
    </procedure>
    
    <procedure id="insertarParametroHistorico" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_ins_historial(#codigo#,#grupo#,#valor#,#fecha#,#usuario#)}
    </procedure> 
        
    <procedure id="actualizarParametro" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_upd_parametro(#grupo#,#codigo#,#anno#,#valor#,#tipoActualizacion#)}
    </procedure>

    <resultMap id="resultBuscarParametro" class="java.util.HashMap">
        <result property="gpa_codigo_grupo" column="gpa_codigo_grupo" jdbcType="char" javaType="String"/>
        <result property="cpa_cod_parametro" column="cpa_cod_parametro" jdbcType="char" javaType="String"/>
    	<result property="gpa_descripcion" column="gpa_descripcion" jdbcType="char" javaType="String"/>        
        <result property="par_anno" column="par_anno" jdbcType="int" javaType="int"/>
        <result property="par_valor" column="par_valor" jdbcType="float" javaType="double"/>
    </resultMap>
	
	<parameterMap id="setBuscarParametro" class="java.util.HashMap">	   
       <parameter property="codigo" jdbcType="VARCHAR" javaType="String" />
       <parameter property="grupo" jdbcType="VARCHAR" javaType="String" />
       <parameter property="anno" jdbcType="INTEGER" javaType="Integer" />
    </parameterMap>
	
    <procedure id="buscarParametro" parameterMap="setBuscarParametro" resultMap="resultBuscarParametro">
        {CALL sp_cns_parametro(?,?,?)}
    </procedure>
    <!-- Declaracion Jurada -->
	 <procedure id="buscarPais" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_pais()}
    </procedure>
	<procedure id="buscarMoneda" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_moneda()}
    </procedure>
	<procedure id="obtenerDjMensual" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_djmensual(#num_identificador#, #periodo#, #rutContraparte#, #tipoContrato#, #eventoInformado#, #numeroPagina#, #cantidadRegistrosPagina#)}
    </procedure>
	<procedure id="ingresarDjMensual" parameterClass="java.util.HashMap" resultClass="java.lang.Long">
        {CALL sp_ins_operacion_mensual(#tipoDeRegistro#,#numeroFormulario#,#codigoDePresentacion#,#rutDeclarante#,#dvDeclarante#,#numeroFolio#,#tipoDeDeclaracion#,#rutContraparte#,#dvContraparte#,#taxId#,#codigoPais#,#tipoRelacionContraparte#,#modalidadContratacion#,#tipoAcuerdo#,#numeroAcuerdo#,#fechaSuscripcionAcuerdo#,
		#numeroIdentificadorContrato#,#fechaSuscripcionContrato#,#eventoInformadoContrato#,#tipoContrato#,#nombreInstrumentoContrato#,#modalidadCumplimientoContrato#,
		#posicionDeclaranteContrato#,#tipoActivoSubyacente#,#codigoActivoSubyacente#,#otrosActivosSubyacente#,#tasaFijaActivoSubyacente#,#tipoSegundoActivoSubyacente#,
		#codigoSegundoActivoSubyacente#,#otrosSegundoActivosSubyacente#,#tasaFijaSegundoActivoSubyacen#,#codigoPrecio#,#precio#,#moneda#,#unidad#,#montoContratadoNocional#,
		#segundaUnidad#,#segundoMontoContratadoNociona#,#fechaVencimiento#,#periodo#)}
    </procedure>	
	<procedure id="modificarDjMensual" parameterClass="java.util.HashMap" resultClass="java.lang.Long">
        {CALL sp_udp_operacion_mensual(#numeroFolio#,#tipoDeDeclaracion#,#rutContraparte#,#dvContraparte#,#taxId#,#codigoPais#,#tipoRelacionContraparte#,#modalidadContratacion#,#tipoAcuerdo#,#numeroAcuerdo#,#fechaSuscripcionAcuerdo#,
		#numeroIdentificadorContrato#,#fechaSuscripcionContrato#,#eventoInformadoContrato#,#tipoContrato#,#nombreInstrumentoContrato#,#modalidadCumplimientoContrato#,
		#posicionDeclaranteContrato#,#tipoActivoSubyacente#,#codigoActivoSubyacente#,#otrosActivosSubyacente#,#tasaFijaActivoSubyacente#,#tipoSegundoActivoSubyacente#,
		#codigoSegundoActivoSubyacente#,#otrosSegundoActivosSubyacente#,#tasaFijaSegundoActivoSubyacen#,#codigoPrecio#,#precio#,#moneda#,#unidad#,#montoContratadoNocional#,#segundaUnidad#,#segundoMontoContratadoNociona#,#fechaVencimiento#,#periodo#,#codEventoOperacion#)}
    </procedure>

<procedure id="eliminarDjMensual" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_eli_operacion_mensual(#codigoEventoOperacion#)}
    </procedure>
	<procedure id="borrarLogEvento" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_eli_log_error(#codigoEventoOperacion#)}
    </procedure>
	<procedure id="agregarLogEvento" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_ins_error_dj(#codigoDjMensual#,#codigoDjAnual#,#fechaError#,#codigoReferenciaSII#,#descripcionError#,#periodo#,#numeroContrato#)}
    </procedure>
	
<procedure id="existePeriodo" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_existe_periodo(#periodo#,#tipoDeclaracion#,#folio#)}
    </procedure>
	<procedure id="existePeriodoRect" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_existe_periodo_rect(#periodo#,#tipoDeclaracion#)}
    </procedure>
	<procedure id="maximoCorrelativo" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_cns_max_correlativo()}
    </procedure>
	<procedure id="ingresarProceso" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_ins_upd_registro_proceso(#esRectificacion#,#esReproceso#,#fechaProceso#,#usuarioProceso#,#periodo#,#tipoDeclaracion#,#folio#,#correlativo#)}
    </procedure>
	<procedure id="actualizarDjOperacion" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_upd_dj_operaciones(#periodo#,#tipoDeclaracion#,#folio#)}
    </procedure>
	<procedure id="obtenerDatosDjMensual" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_datos_djmensual(#periodo#)}
    </procedure>
	<procedure id="consultarLogSistema" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		{CALL sp_cns_log_sistema(#periodo#,#numeroPagina#,#cantidadRegistrosPagina#)}
    </procedure>
	<procedure id="consultarProductosCuentasContables" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_prod_cuentas()}
    </procedure>
	<procedure id="consultarPortafolioCuentasContables" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_portafolio_cuenta()}
    </procedure>
	<procedure id="obtenerContatosCliente" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		{CALL sp_cns_contratos(#rutCliente#)}
    </procedure>
	<procedure id="obtieneDatosCuentasContablesDj" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		{CALL sp_cns_cuentas_contables(#ctaContable#, #codProducto#, #codPortafolio#, #numeroPagina#, #cantidadRegistrosPagina#)}
    </procedure>
	<procedure id="modificarDatosCuentaContable" parameterClass="java.util.HashMap" resultClass="int">
		{CALL sp_upd_cuenta_contable(#ctaContable#, #codProducto#, #codPortafolio#, #codMoneda1#, #codMoneda2#, #fechaModifCuenta#, #estadoCuenta#, #usuario#)}
    </procedure>
	<procedure id="ingresarDatosCuentaContable" parameterClass="java.util.HashMap" resultClass="int">
		{CALL sp_ins_cuenta_contable(#ctaContable#, #codProducto#, #codPortafolio#, #codMoneda1#, #codMoneda2#, #estadoCuenta#, #fechaInsercion#)}
    </procedure>
	<procedure id="consultarExisteCuentaContable" parameterClass="java.util.HashMap" resultClass="int">
		{CALL sp_existe_cuenta_contable(#ctaContable#)}
    </procedure>
<procedure id="obtenerCantidadRegistrosDjMensual" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_cns_cantReg_djmensual(#num_identificador#, #periodo#, #rutContraparte#, #tipoContrato#, #eventoInformadoContrato#)}
    </procedure>
	<procedure id="obtenerCantidadRegistrosLogErrores" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_cns_cantReg_log_sistema(#periodo#)}
    </procedure>
	<procedure id="obtenerCantidadRegistrosCtaCont" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_cns_cantReg_CtaCto(#ctaContable#, #codProducto#, #codPortafolio#)}
    </procedure>
	<procedure id="obtenerDjAnual" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_djanual(#num_identificador#, #periodo#, #rutContraparte#, #tipoContrato#,#numPagina#,#cantRegistros#)} 
    </procedure>
    <procedure id="obtenerCantidadRegistrosDjAnual" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_cns_cantdjanual(#num_identificador#, #periodo#, #rutContraparte#, #tipoContrato#)}
    </procedure>
	<procedure id="ingresarDjAnual" parameterClass="java.util.HashMap" resultClass="java.lang.Long">
        {CALL sp_ins_operacion_anual(#tipoDeRegistro#,#numeroFormulario#,#codigoDePresentacion#,
		#numeroFolio#,#tipoDeDeclaracion#,#rutDeclarante#,#dvDeclarante#,
		#rutContraparte#,#dvContraparte#,#taxId#, #codigoPais#,
		#tipoRelacionContraparte#,#modalidadContratacion#,#tipoAcuerdo#,
		#numeroAcuerdo#,#fechaSuscripcionAcuerdo#,#numeroIdentificadorContrato#,
		#fechaSuscripcionContrato#,#contratoVencidoEjercicio#,#estadoContratoConfirmacion#,#tipoContrato#,
		#nombreInstrumentoContrato#, #modalidadCumplimientoContrato#,#posicionDeclaranteContrato#,
		#tipoActivoSubyacente#,#codigoActivoSubyacente#,#otrosActivosSubyacente#,
		#tasaFijaActivoSubyacente#,#tipoSegundoActivoSubyacente#,#codigoSegundoActivoSubyacente#,
		#otrosSegundoActivosSubyacente#,#tasaFijaSegundoActivoSubyacen#,#codigoPrecio#,
		#precio#,#moneda#,#unidad#,#montoContratadoNocional#,#segundaUnidad#,
		#segundoMontoContratadoNociona#,#fechaVencimiento#,#fechaLiquidacionEjercicioOpc#,
		#codigoDePrecioMercadoSubyacen#,#precioMercadoSubyacente#,#valorJustoDelContratoConfirma#,
		#resultadoEjercicio#,#cuentaContableResultadoEjerci#,#efectoEnPatrimonio#, 
		#cuentaContableRegistroEnPatri#,#comisionPactada#,#primaTotal#,
		#inversionInicial#,#otrosGastosAsociadosContrato#,#otrosIngresosAsociadosContra#,
		#montoEfectuadoEjercicio#,#modalidadDePagoEfectuadoEjerc#,#saldoDeGarantiaAlCierre#,#periodo#)}
    </procedure>
	<procedure id="modificarDjAnual" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_upd_operacion_anual(#tipoDeRegistro#,#numeroFormulario#,#codigoDePresentacion#,
		#numeroFolio#,#tipoDeDeclaracion#,#rutDeclarante#,#dvDeclarante#,
		#rutContraparte#,#dvContraparte#,#taxId#, #codigoPais#,
		#tipoRelacionContraparte#,#modalidadContratacion#,#tipoAcuerdo#,
		#numeroAcuerdo#,#fechaSuscripcionAcuerdo#,#numeroIdentificadorContrato#,
		#fechaSuscripcionContrato#,#contratoVencidoEjercicio#,#estadoContratoConfirmacion#,#tipoContrato#,
		#nombreInstrumentoContrato#, #modalidadCumplimientoContrato#,#posicionDeclaranteContrato#,
		#tipoActivoSubyacente#,#codigoActivoSubyacente#,#otrosActivosSubyacente#,
		#tasaFijaActivoSubyacente#,#tipoSegundoActivoSubyacente#,#codigoSegundoActivoSubyacente#,
		#otrosSegundoActivosSubyacente#,#tasaFijaSegundoActivoSubyacen#,#codigoPrecio#,
		#precio#,#moneda#,#unidad#,#montoContratadoNocional#,#segundaUnidad#,
		#segundoMontoContratadoNociona#,#fechaVencimiento#,#fechaLiquidacionEjercicioOpc#,
		#codigoDePrecioMercadoSubyacen#,#precioMercadoSubyacente#,#valorJustoDelContratoConfirma#,
		#resultadoEjercicio#,#cuentaContableResultadoEjerci#,#efectoEnPatrimonio#, 
		#cuentaContableRegistroEnPatri#,#comisionPactada#,#primaTotal#,
		#inversionInicial#,#otrosGastosAsociadosContrato#,#otrosIngresosAsociadosContra#,
		#montoEfectuadoEjercicio#,#modalidadDePagoEfectuadoEjerc#,#saldoDeGarantiaAlCierre#,#periodo#,#codDjAnual#)}
    </procedure>
	<procedure id="eliminarDjAnual" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_eli_operacion_anual(#codDjAnual#)}
    </procedure>
    <procedure id="borrarLogEventoAnual" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_eli_log_error_anual(#codigoEventoOperacion#)}
    </procedure>
    <procedure id="existeGeneracionDJ" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_ExisteGeneracionDJ(#periodo#)}
    </procedure>
	<procedure id="consultarPeriodoDisponible" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_periodo_disp()}
    </procedure>
	<procedure id="insertarPeticionGeneracion" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_ing_generador(#periodo#, #folio#)}
    </procedure>
    <procedure id="consultaLogErrorDjAnual" parameterClass="java.util.HashMap" resultClass="int">
        {CALL sp_cns_cant_log_error_djAnual(#periodo#)}
    </procedure>
    <procedure id="consultarLogError" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
        {CALL sp_cns_log_error_sistema(#periodo#,#tipo#,#numeroPagina#,#cantidadRegistrosPagina#)}
    </procedure>
<!-- Fin Declaracion Jurada -->
</sqlMap>

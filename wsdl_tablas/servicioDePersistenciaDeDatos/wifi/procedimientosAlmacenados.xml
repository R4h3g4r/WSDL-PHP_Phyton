<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="wifi.procedimientosAlmacenados">
	<parameterMap id="setInsertarSolicitud" class="java.util.HashMap">
		<parameter property="rut"				jdbcType="INTEGER"	javaType="java.lang.Long" />
		<parameter property="digitoVerificador"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="nombres" 			jdbcType="CHAR"		javaType="String" />
		<parameter property="apellidoPaterno"	jdbcType="CHAR"		javaType="String" />
		<parameter property="apellidoMaterno"	jdbcType="CHAR"		javaType="String" />
		<parameter property="celular"			jdbcType="CHAR"		javaType="String" />
		<parameter property="telefono"			jdbcType="CHAR"		javaType="String" />
		<parameter property="cliente"			jdbcType="CHAR"		javaType="String" />
		<parameter property="email"				jdbcType="CHAR"		javaType="String" />
		<parameter property="clave"				jdbcType="INTEGER"	javaType="java.lang.Integer" />		
		<parameter property="fechaExpiracion"	jdbcType="CHAR"		javaType="String" />
	</parameterMap>
	<procedure id="ingresarSolicitud" parameterMap="setInsertarSolicitud" resultClass="int">
		{ CALL sp_ins_sol_shs( ?,?,?,?,?,?,?,?,?,?,? ) }
	</procedure>
	
	<parameterMap id="setConsultaSolicitud" class="java.util.HashMap">
		<parameter property="rutCliente"		jdbcType="INTEGER"	javaType="java.lang.Long" />
	</parameterMap>

	<resultMap id="getConsultaSolicitud" class="java.util.HashMap">		<result property="numeroSolicitud"	column="numSol"  		javaType="java.lang.Long"/>
		<result property="numeroCelular"  	column="numFono" 		javaType="String" />
		<result property="clave"   			column="claveAcceso" 	javaType="java.lang.Integer" />		
	</resultMap>
	
	<procedure id="consultaSolicitudDeAcceso" parameterMap="setConsultaSolicitud" resultMap="getConsultaSolicitud">
		{ CALL sp_cns_sol_shs( ? ) }
	</procedure>	
	
	<parameterMap id="setInsertarSolicitudCliente" class="java.util.HashMap">
		<parameter property="rut"				jdbcType="INTEGER"	javaType="java.lang.Long" />
		<parameter property="digitoVerificador"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="cliente"			jdbcType="CHAR"		javaType="String" />
		<parameter property="clave"				jdbcType="INTEGER"	javaType="java.lang.Integer" />		
		<parameter property="fechaExpiracion"	jdbcType="CHAR"		javaType="String" />
	</parameterMap>

	<procedure id="ingresarSolicitudCliente" parameterMap="setInsertarSolicitudCliente" resultClass="java.lang.Long">
		{ CALL sp_ins_clv_shs( ?,?,?,?,? ) }
	</procedure>

	<parameterMap id="setConsultaClaveSolicitudDeAcceso" class="java.util.HashMap">
		<parameter property="numeroSolicitud"				jdbcType="INTEGER"	javaType="java.lang.Long" />
	</parameterMap>

	<resultMap id="getConsultaClaveSolicitudDeAcceso" class="java.util.HashMap">		<result property="claveSolicitud"   			column="claveSolicitud" 	javaType="java.lang.Integer" />		
	</resultMap>
	
	<procedure id="consultaClaveSolicitudDeAcceso" parameterMap="setConsultaClaveSolicitudDeAcceso" resultMap="getConsultaClaveSolicitudDeAcceso">
		{ CALL sp_cns_clv_shs( ? ) }
	</procedure>

	<parameterMap id="setActualizaFechaConexion" class="java.util.HashMap">
		<parameter property="numeroSolicitud"			jdbcType="INTEGER"	javaType="java.lang.Long" />
		<parameter property="fechaConexion"				jdbcType="datetime"	javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler" />
	</parameterMap>
	
	<procedure id="actualizaFechaConexion" parameterMap="setActualizaFechaConexion" resultClass="int">
		{ CALL sp_act_clv_shs( ?,? ) }
	</procedure>
	
</sqlMap>
<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
	 
<sqlMap namespace="bancrt.procedimientosAlmacenados">	

    <parameterMap id="setInsertarDatoCCE" class="java.util.HashMap">
		<parameter property="cnv_num"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="emp_num_rut"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="emp_vrt_rut"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cec_num_cta"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_fmt_fec"		jdbcType="VARCHAR" javaType="String" />
        <parameter property="cce_acu_fre"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_fre_dia"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_fre_sem"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_fre_qnl"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_fre_msl"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_acm_dia"		jdbcType="NUMERIC" javaType="integer" />
		<parameter property="cce_acm_sem"		jdbcType="NUMERIC" javaType="integer" />
		<parameter property="cce_acm_qnl"       jdbcType="NUMERIC" javaType="integer" />
		<parameter property="cce_acm_msl"		jdbcType="NUMERIC" javaType="integer" />
		<parameter property="cce_tip_via"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_num_fol"		jdbcType="NUMERIC" javaType="integer" />
		<parameter property="cce_fmt_rec"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_fmt_pac"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="cce_ind_ofi"		jdbcType="VARCHAR" javaType="String" />
	</parameterMap>
    <!-- InsertCCE (@cnv_num char(10), @emp_num_rut char(12), @emp_vrt_rut char(1), @cec_num_cta char(12),
         		    @cce_fmt_fec char(1), @cce_acu_fre char(1), @cce_fre_dia char(1), @cce_fre_sem char(1),
		            @cce_fre_qnl char(1),
		   @cce_fre_msl     char   (1),
		   @cce_acm_dia     int,
		   @cce_acm_sem     int,
		   @cce_acm_qnl     int,
		   @cce_acm_msl     int,
		   @cce_tip_via     char   (5),
		   @cce_num_fol     int,
		   @cce_fmt_rec	    char   (1),
		   @cce_fmt_pac	    char   (1),
		   @cce_ind_ofi     char   (1)
		  )-->
	<procedure id="insertarDatoCCE" parameterMap="setInsertarDatoCCE" resultClass="java.util.HashMap">
		 {CALL InsertCCE (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
		<!-- {CALL InsertCCE (#cnv_num#, #emp_num_rut#, #emp_vrt_rut#, #cec_num_cta#, #cce_fmt_fec#, #cce_acu_fre#, #cce_fre_dia#, #cce_fre_sem#, #cce_fre_qnl#, #cce_fre_msl#, #cce_acm_dia#, #cce_acm_sem#, #cce_acm_qnl#, #cce_acm_msl#, #cce_tip_via#, #cce_num_fol#, #cce_fmt_rec#, #cce_fmt_pac#, #cce_ind_ofi#)}-->
	</procedure>



    <parameterMap id="setEliminarCtaMarcadasCCE" class="java.util.HashMap">
		<parameter property="p_cnv_num"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_emp_num_rut"		jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cec_num_cta"		jdbcType="VARCHAR" javaType="String" />
	</parameterMap>
	<resultMap id="getEliminarCtaMarcadasCCE" class="java.util.HashMap">
		<result  property="resultado" jdbcType="VARCHAR"  javaType="String" />
	</resultMap>
	<!-- sp_CEII_elimina_ctas_marc_CCE (@p_cnv_num char(10), @p_emp_num_rut char(12), @p_cec_num_cta char(12)) -->
    <procedure id="eliminarCtaMarcadasCCE" parameterMap="setEliminarCtaMarcadasCCE" resultMap="getEliminarCtaMarcadasCCE">
		 {CALL sp_CEII_elimina_ctas_marc_CCE (?, ?, ?)}
	</procedure>


	<!--
		sp_CEII_actualizarCartolaERP (	@cerpfmtfec char(1), @cerpacufre char(1), @cerpfredia char(1),
	                                 	@cerpfresem char(1), @cerpfreqnc char(1), @cerpfremns char(1),
									 	@cerpindofi char(1), @cnvnum char (10), @empnumrut char(12),
									 	@cecnumcta char(12)) 
	-->
	<parameterMap id="setActualizarCartolaERP" 	class="java.util.HashMap">
		<parameter property="p_cerpfmtfec"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cerpacufre"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cerpfredia"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cerpfresem"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cerpfreqnc"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cerpfremns"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cerpindofi"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cnvnum"				jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_empnumrut"			jdbcType="VARCHAR" javaType="String" />
		<parameter property="p_cecnumcta"			jdbcType="VARCHAR" javaType="String" />
	</parameterMap>
	
	<resultMap id="getActualizarCartolaERP" class="java.util.HashMap">
		<result  property="estado" 	jdbcType="VARCHAR"  javaType="String" />
		<result  property="mensaje" jdbcType="VARCHAR"  javaType="String" />
	</resultMap>
	
    <procedure id="actualizarCartolaERP" parameterMap="setActualizarCartolaERP" resultMap="getActualizarCartolaERP">
		 {CALL sp_CEII_actualizarCartolaERP (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
	</procedure>
	
	
	<!--
		sp_CEII_obtenerCtasCartolaERP (@p_cnv_num char (10)    , 
                                       @p_emp_num_rut char (12))
	-->
	
	<parameterMap id="setObtenerCartolasERP" 	class="java.util.HashMap">
		<parameter property="p_cnvnum"				jdbcType="VARCHAR" javaType="String"  />
		<parameter property="p_empnumrut"			jdbcType="VARCHAR" javaType="String" />
	</parameterMap>
		
	<resultMap id="getObtenerCartolasERP" class="java.util.HashMap">
		<result  property="cec_num_cta" 	jdbcType="VARCHAR"  javaType="String" />
		<result  property="cerp_fmt_fec" 	jdbcType="VARCHAR"  javaType="String" />
		<result  property="cerp_acu_fre" 	jdbcType="VARCHAR"  javaType="String" />
		<result  property="cerp_fre_dia" 	jdbcType="VARCHAR"  javaType="String" />
		<result  property="cerp_fre_sem" 	jdbcType="VARCHAR"  javaType="String" />
		<result  property="cerp_fre_qnl" 	jdbcType="VARCHAR"  javaType="String" />
		<result  property="cerp_fre_msl" 	jdbcType="VARCHAR"  javaType="String" />
		<result  property="cerp_ind_ofi" 	jdbcType="VARCHAR"  javaType="String" />
	</resultMap>

    <procedure id="obtenerCartolasERP" parameterMap="setObtenerCartolasERP" resultMap="getObtenerCartolasERP">
		 {CALL sp_CEII_obtenerCtasCartolaERP (?, ?)}
	</procedure>
	
	<parameterMap id="setObtieneDetalleCartola" class="java.util.HashMap">
		<parameter property="rut_empresa" jdbcType="VARCHAR" javaType="String" />
		<parameter property="fecha" jdbcType="VARCHAR" javaType="String" />
		<parameter property="servicio" jdbcType="VARCHAR" javaType="String" />
		<parameter property="tipo_cartola" jdbcType="VARCHAR" javaType="String" />
		<parameter property="forma" jdbcType="VARCHAR" javaType="String" />
		<parameter property="cuenta" jdbcType="VARCHAR" javaType="String" />
	</parameterMap>
	
	<resultMap id="getObtieneDetalleCartola" class="java.util.HashMap">
		<result property="nombre_archivo_banco"	column="nombre_archivo_banco"	jdbcType="CHAR"	javaType="String" />
		<result property="nombre_archivo_cliente"	column="nombre_archivo_cliente"	jdbcType="CHAR"	javaType="String" />
		<result property="numero_cuenta"	column="numero_cuenta"	jdbcType="CHAR"	javaType="String" />
		<result property="banco"	column="banco"	jdbcType="CHAR"	javaType="String" />
	</resultMap>
	
	<procedure id="obtenerDetalleCartola" parameterMap="setObtieneDetalleCartola" resultMap="getObtieneDetalleCartola">
		{ CALL sp_obtiene_detalle_cartola(?,?,?,?,?,?) }
	</procedure>
	
	<parameterMap id="setActualizaEstadoTar" class="java.util.HashMap">
		<parameter property="rut_empresa"   jdbcType="CHAR" javaType="String" />
		<parameter property="fecha"   jdbcType="CHAR" javaType="String" />
		<parameter property="tipo_cartola"   jdbcType="CHAR" javaType="String" />
	</parameterMap>
	
	<procedure id="actualizaEstadoTar" parameterMap="setActualizaEstadoTar" resultClass="int">
		{ CALL sp_actualiza_estado_arc_tar(?,?,?) }
	</procedure>

	<parameterMap id="setObtieneArchivosRendiciones" class="java.util.HashMap">
		<parameter property="rut_empresa" jdbcType="VARCHAR" javaType="String" />
		<parameter property="convenio" jdbcType="VARCHAR" javaType="String" />
		<parameter property="tipo_archivo" jdbcType="VARCHAR" javaType="String" />
		<parameter property="archivo_cliente" jdbcType="VARCHAR" javaType="String" />
		<parameter property="fecha_inicio" jdbcType="DATETIME" javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler" />
		<parameter property="fecha_fin" jdbcType="DATETIME" javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler" />
	</parameterMap>
	
	<resultMap id="getObtieneArchivosRendiciones" class="java.util.HashMap">
		<result property="tar_arc_bci"	column="tar_arc_bci" jdbcType="CHAR" javaType="String" />
		<result property="tar_hor_prc"	column="tar_hor_prc" jdbcType="CHAR" javaType="String" />
		<result property="tar_gls_des" column="tar_gls_des"	jdbcType="CHAR"	javaType="String" />
		<result property="tar_cod_est" column="tar_cod_est"	jdbcType="CHAR"	javaType="String" />
		<result property="cnv_tip" column="cnv_tip"	jdbcType="CHAR"	javaType="String" />
	</resultMap>
	
	<procedure id="obtenerArchivosRendiciones" parameterMap="setObtieneArchivosRendiciones" resultMap="getObtieneArchivosRendiciones">
		{ CALL sp_obtener_arch_rend(?,?,?,?,?,?) }
	</procedure>
	
	<resultMap id="movimientoCuentaTO" class="java.util.HashMap">
	    <result property="numCtaCte" 			column="numCtaCte"		    jdbcType="CHAR(8)" 	javaType="String" />
	    <result property="fechaMovimiento" 		column="fechaMovimiento" 	jdbcType="DATETIME" javaType="String" />
	    <result property="serial"				column="serial" 			jdbcType="INTEGER" 	javaType="String" />
	    <result property="codigoOficina"		column="codigoOficina" 		jdbcType="CHAR(03)" javaType="String" />
	    <result property="montoMovimiento"		column="montoMovimiento" 	jdbcType="MONEY" 	javaType="String" />
	    <result property="tipoMovimiento"		column="tipoMovimiento" 	jdbcType="CHAR(04)" javaType="String" />
		<result property="saldoAcumulado"		column="saldoAcumulado" 	jdbcType="MONEY" 	javaType="String" />
		<result property="paginaActual"			column="paginaActual" 		jdbcType="INTEGER" 	javaType="int" />
		<result property="totalPaginas"			column="totalPaginas" 		jdbcType="INTEGER" 	javaType="int" />
	</resultMap>
	
    <procedure id="traerMovimientos" parameterClass="java.util.HashMap" resultMap="movimientoCuentaTO">
        {CALL sp_cns_mov_cct(#ctaCte#, #fechaInicio#, #fechaFin#, #numeroPagina#, #filasPagina#)}
    </procedure>
    
<parameterMap id="setObtieneConfCartolasElectronicas" class="java.util.HashMap">
		<parameter property="cnv_num" 		jdbcType="VARCHAR" javaType="String" />
		<parameter property="emp_num_rut" 	jdbcType="VARCHAR" javaType="String" />
	</parameterMap>
	
	<resultMap id="getObtieneConfCartolasElectronicas" class="java.util.HashMap">
		<result property="cec_num_cta" jdbcType="VARCHAR" javaType="String" />
   		<result property="cce_fmt_fec" jdbcType="VARCHAR" javaType="String" />
		<result property="cce_acu_fre" jdbcType="VARCHAR" javaType="String" />
		<result property="cce_fre_dia" jdbcType="VARCHAR" javaType="String" />
		<result property="cce_fre_sem" jdbcType="VARCHAR" javaType="String" />
		<result property="cce_fre_qnl" jdbcType="VARCHAR" javaType="String" />
		<result property="cce_fre_msl" jdbcType="VARCHAR" javaType="String" />
		<result property="cce_ind_ofi" jdbcType="VARCHAR" javaType="String" />
	</resultMap>
	
	<procedure id="obtieneConfCartolasElectronicas" parameterMap="setObtieneConfCartolasElectronicas" resultMap="getObtieneConfCartolasElectronicas">
		{ CALL sp_con_conf_cartolas_electroni (?, ?)}
	</procedure>

</sqlMap>	



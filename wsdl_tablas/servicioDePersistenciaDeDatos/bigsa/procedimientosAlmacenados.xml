<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
	
<sqlMap namespace="bigsa.procedimientosAlmacenados">


	<procedure id="consultaDeNegocio" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		{CALL sp_consulta_neg(#cod_canal#, #cod_regional#, #cod_sucursal#, #cod_ramo#, #cod_ejecbc#, #fec_emi_desde#,
		#fec_emi_hasta#, #fec_pro_desde#, #fec_pro_hasta#, #rut_cliente#, #doc_codigo#, #cod_estado#)}
	</procedure>
	
	<procedure id="cargaCriteriosConsultaDeNegocio" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		{CALL sp_cargacrit_cneg(#indice#, #deseje#, #cnl#, #reg#, #suc#)}
	</procedure>
	
	
<procedure id="obtienePolizasCliente" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		{CALL sp_bci_pers_resumen_polizas(#rut_cliente#)}
	</procedure>
	
	<resultMap id="getDetallePolizaHogar" class="java.util.HashMap">
		<!-- 	<result property="DOCU_NRO_POLIZA"				column="DOCU_NRO_POLIZA"           jdbcType="CHAR"    	javaType="String" />  -->
			<result property="DOCU_CODIGO"                  column="DOCU_CODIGO"               jdbcType="NUMERIC"    	javaType="String" /> 
			<result property="HOG_DIRECCION"                column="HOG_DIRECCION"             jdbcType="CHAR"    	javaType="String" /> 
			<result property="HOG_COD_REGION"               column="HOG_COD_REGION"            jdbcType="NUMERIC"    	javaType="String" /> 
			<result property="HOG_NOM_REGION"               column="HOG_NOM_REGION"            jdbcType="CHAR"    	javaType="String" /> 
			<result property="HOG_COD_CIUDAD"               column="HOG_COD_CIUDAD"            jdbcType="NUMERIC"    	javaType="String" /> 
			<result property="HOG_NOM_CIUDAD"               column="HOG_NOM_CIUDAD"            jdbcType="CHAR"    	javaType="String" /> 
			<result property="HOG_COD_COMUNA"               column="HOG_COD_COMUNA"            jdbcType="NUMERIC"    	javaType="String" /> 
			<result property="HOG_NOM_COMUNA"               column="HOG_NOM_COMUNA"            jdbcType="CHAR"    	javaType="String" /> 
			<result property="HOG_COD_TIPO_CONSTRUCCION"    column="HOG_COD_TIPO_CONSTRUCCION" jdbcType="NUMERIC"    	javaType="String" /> 
			<result property="HOG_TIPO_VIVIENDA"            column="HOG_TIPO_VIVIENDA"         jdbcType="CHAR"    	javaType="String" /> 
	</resultMap>
	
	<procedure id="obtieneDetallePolizaHogar" parameterClass="java.util.HashMap" resultMap="getDetallePolizaHogar">
		{CALL sp_bci_pers_det_materia_poliza(#num_poliza#)}
	</procedure>
	
	<resultMap id="getDetallePolizaAutomotriz" class="java.util.HashMap">
		<result property="DOCU_CODIGO"		column="DOCU_CODIGO"     jdbcType="NUMERIC"    	javaType="String" />
		<!-- <result property="DOCU_NRO_POLIZA"      column="DOCU_NRO_POLIZA" jdbcType="CHAR"    	javaType="String" /> -->
		<result property="VEH_NRO_PATENTE"      column="VEH_NRO_PATENTE" jdbcType="CHAR"    	javaType="String" />
		<result property="VEH_NRO_MOTOR"        column="VEH_NRO_MOTOR"   jdbcType="CHAR"    	javaType="String" />
		<result property="VEH_NRO_CHASSIS"      column="VEH_NRO_CHASSIS" jdbcType="CHAR"    	javaType="String" />
		<result property="VEH_ANO"              column="VEH_ANO"         jdbcType="NUMERIC"    	javaType="String" />
		<result property="VEH_MRCA_COD"         column="VEH_MRCA_COD"    jdbcType="CHAR"    	javaType="String" />
		<result property="VEH_MRCA_DESC"        column="VEH_MRCA_DESC"   jdbcType="CHAR"    	javaType="String" />
		<result property="VEH_MODELO_COD"       column="VEH_MODELO_COD"  jdbcType="NUMERIC"    	javaType="String" />
		<result property="VEH_MODELO_DESC"      column="VEH_MODELO_DESC" jdbcType="CHAR"    	javaType="String" />
		<result property="VEH_COLOR_COD"        column="VEH_COLOR_COD"   jdbcType="NUMERIC"    	javaType="String" />
		<result property="VEH_COLOR_DESC"       column="VEH_COLOR_DESC"  jdbcType="CHAR"    	javaType="String" />			
	</resultMap>
	
	<procedure id="obtieneDetallePolizaAutomotriz" parameterClass="java.util.HashMap" resultMap="getDetallePolizaAutomotriz">
		{CALL sp_bci_pers_det_materia_poliza(#num_poliza#)}
	</procedure>
	
	<resultMap id="getDetallePolizaMultiproteccion" class="java.util.HashMap">
		<result property="GLOSA_MULTI"		column="GLOSA_MULTI"     jdbcType="CHAR"    	javaType="String" />
	</resultMap>
	
	<procedure id="obtieneDetallePolizaMultiproteccion" parameterClass="java.util.HashMap" resultMap="getDetallePolizaMultiproteccion">
		{CALL sp_bci_pers_det_materia_poliza(#num_poliza#)}
	</procedure>
	
	<resultMap id="getDetallePolizaPersona" class="java.util.HashMap">
		<result property="TIPO"					column="TIPO"  				jdbcType="CHAR"    	javaType="String" />                    
		<result property="RUT"                  column="RUT"  				jdbcType="CHAR"    	javaType="String" />                    
		<result property="NOMBRES"              column="NOMBRES"  			jdbcType="CHAR"    	javaType="String" />            
		<result property="APE_PATERNO"          column="APE_PATERNO"  		jdbcType="CHAR"    	javaType="String" />            
		<result property="APE_MATERNO"          column="APE_MATERNO"  		jdbcType="CHAR"    	javaType="String" />            
		<result property="FECHA_NACIMIENTO"     column="FECHA_NACIMIENTO"  	jdbcType="DATE"    	javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler" />   
		<result property="PARENTESCO"           column="PARENTESCO"  		jdbcType="CHAR"    	javaType="String" />  			
	</resultMap>
	
	<procedure id="obtieneDetallePolizaPersona" parameterClass="java.util.HashMap" resultMap="getDetallePolizaPersona">
		{CALL sp_bci_pers_det_materia_poliza(#num_poliza#)}
	</procedure>

    <parameterMap id="setObtenerVehiculosSeguroVigente" class="java.util.HashMap">
        <parameter property="rut_cliente" jdbcType="INT"  javaType="java.lang.Long" />
    </parameterMap>
 
    <resultMap id="getObtenerVehiculosSeguroVigente" class="java.util.HashMap">
        <result  property="codDocumento"        jdbcType="INT"          javaType="java.lang.Integer"     column="docu_codigo" />
        <result  property="nroPoliza"           jdbcType="varchar"      javaType="java.lang.String"      column="docu_nro_poliza" />
        <result  property="digPoliza"           jdbcType="varchar"      javaType="java.lang.String"      column="docu_dig_poliza" />
        <result  property="nroPatente"          jdbcType="varchar"      javaType="java.lang.String"      column="nro_patente" />
        <result  property="nroMotor"            jdbcType="varchar"      javaType="java.lang.String"      column="nro_motor" />
        <result  property="nroChasis"          jdbcType="varchar"      javaType="java.lang.String"      column="nro_chasis" />
    </resultMap>
    
    <procedure id="obtenerVehiculosSeguroVigente" parameterMap="setObtenerVehiculosSeguroVigente" resultMap="getObtenerVehiculosSeguroVigente">
        { CALL sp_cns_seg_vig_aut(?) }
    </procedure>

    <parameterMap id="setObtenerSegurosPropiedades" class="java.util.HashMap">
        <parameter property="rut_cliente"      jdbcType="INT"         javaType="java.lang.Long" />
        <parameter property="codigo_seguro"    jdbcType="varchar"     javaType="java.lang.String" />
    </parameterMap>
 
    <resultMap id="getObtenerSegurosPropiedades" class="java.util.HashMap">
        <result  property="codDocumento"            jdbcType="INT"          javaType="java.lang.Integer"     column="docu_codigo" />
        <result  property="nroPoliza"               jdbcType="varchar"      javaType="java.lang.String"      column="docu_nro_poliza" />
        <result  property="digPoliza"               jdbcType="varchar"      javaType="java.lang.String"      column="docu_dig_poliza" />
        <result  property="nombreSeguro"            jdbcType="varchar"      javaType="java.lang.String"      column="nombre_seguro" />
        <result  property="bienAsegurado"           jdbcType="varchar"      javaType="java.lang.String"      column="bien_asegurado" />
        <result  property="nombreComuna"            jdbcType="varchar"      javaType="java.lang.String"      column="nombre_comuna" />
        <result  property="nombreRegion"            jdbcType="varchar"      javaType="java.lang.String"      column="nombre_region" />
        <result  property="compania"                jdbcType="varchar"      javaType="java.lang.String"      column="compania" />
        <result  property="inicioVigencia"          jdbcType="DATE"         javaType="java.util.Date"        column="fecha_inicio_vigencia" />
        <result  property="terminoVigencia"         jdbcType="DATE"         javaType="java.util.Date"        column="fecha_termino_vigencia" />
        <result  property="codEstado"               jdbcType="INT"          javaType="java.lang.Integer"     column="codigo_estado" />
    </resultMap>

    <procedure id="obtenerSegurosPropiedades" parameterMap="setObtenerSegurosPropiedades" resultMap="getObtenerSegurosPropiedades">
        { CALL sp_cns_seguros(?,?) }
    </procedure>
</sqlMap>	
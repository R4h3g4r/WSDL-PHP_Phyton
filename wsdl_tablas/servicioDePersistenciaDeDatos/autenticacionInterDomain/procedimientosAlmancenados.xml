<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="autenticacionInterDomain.procedimientosAlmancenados">
    <resultMap id="resultadoConsultarPKI" class="java.util.HashMap" >
        <result property="rut"   		 		column="aut_rut"  />
        <result property="dv"  					column="aut_dv" />
				<result property="token"  			column="aut_token" />
				<result property="publicKey1"  	column="aut_publickey1" />
				<result property="publicKey2"  	column="aut_publickey2" />
				<result property="expiracion"  	column="aut_expiracion" />
        <result property="page"   		 	column="aut_page"  />
        <result property="parametros"  	column="aut_parametros" />
    </resultMap>
    <procedure id="insertarPKI" parameterClass="java.util.HashMap">
        {#result,jdbcType=INTEGER,mode=OUT# = CALL sp_ins_aut(#autRut#,
                                                              #autDv#,
                                                              #autToken#,
                                                              #autPublicKey1#,
                                                              #autPublicKey2#,
                                                              #autExpiracion#,
                                                              #autPage#,
                                                              #autParametros#)
        }
    </procedure>


    <procedure id="consultarPKI"
                   parameterClass="java.util.HashMap"
                   resultMap="resultadoConsultarPKI">
        {CALL sp_con_pki_aut(#autRut#,#autDv#,#autToken#)}
    </procedure>


    <procedure id="eliminarPKI" parameterClass="java.util.HashMap">
        {#result,jdbcType=INTEGER,mode=OUT# = CALL sp_eli_aut(#autRut#,
                                                              #autDv#,
                                                              #autToken#)
        }
    </procedure>   
    
    <procedure id="eliminarPKIExpirados" parameterClass="java.util.HashMap">
        {#result,jdbcType=INTEGER,mode=OUT# = CALL sp_eli_aut_exp(#autExpiracion#)
        }
    </procedure>     
</sqlMap>
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">


<sqlMap namespace="invpro.procedimientosAlmacenados">

		<parameterMap id="setIngresarInversionProgramada" class="java.util.HashMap">
	  		
	  		
	  		<parameter property="CodigoProducto"     jdbcType="INTEGER"   javaType="java.lang.Integer" />
	  		<parameter property="TipoProducto"       jdbcType="CHAR"      javaType="String" />
	  		<parameter property="RutCliente"         jdbcType="INTEGER"   javaType="java.lang.Integer" />
	  		<parameter property="DigVerificador"     jdbcType="CHAR"      javaType="String" />
	  		<parameter property="CtaCargoCliente"    jdbcType="INTENGER"  javaType="java.lang.Integer" />
	  		<parameter property="MontoInversion"     jdbcType="DECIMAL"   javaType="java.lang.Double" />
	  		<parameter property="CtaCteDestino"      jdbcType="CHAR"      javaType="String" />
	  		<parameter property="EstadoInversion"    jdbcType="CHAR"      javaType="String" />
	  		<parameter property="TipoInversion"      jdbcType="CHAR"      javaType="String" />
	  		<parameter property="Mailcliente"        jdbcType="CHAR"      javaType="String" />
	  		<parameter property="NombreProducto"     jdbcType="CHAR"      javaType="String" />
	  		<parameter property="PeriodicidadInver"  jdbcType="INTEGER"   javaType="java.lang.Integer" />
	  		<parameter property="FechaCargo"         jdbcType="DATATIME"  javaType="java.util.Date" />
	  		<parameter property="TipoMoneda"         jdbcType="CHAR"      javaType="String" />
	  		<parameter property="Responsable"        jdbcType="CHAR"      javaType="String" />
			<parameter property="CanalDeIngreso"     jdbcType="CHAR"      javaType="String" />
			<parameter property="NombreDelCliente"   jdbcType="CHAR"      javaType="String" />  
            <parameter property="autorizaInversion"	 jdbcType="CHAR"      javaType="String" />
            
		</parameterMap>
		<procedure id="ingresarInversionProgramada" parameterMap="setIngresarInversionProgramada" resultClass="int">
	      { CALL sp_InsertObjInverProg( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
		</procedure>

	<parameterMap id="setInversionProgramada" class="java.util.HashMap">
		<parameter property="rut"      	jdbcType="INTEGER" 		javaType="java.lang.Integer" />
		<parameter property="dv"	jdbcType="CHAR" 		javaType="String"   />
	</parameterMap>

	
	<parameterMap id="setCambiaEstadoInversionProgramada" class="java.util.HashMap">
		<parameter property="numeroOperacion"      	jdbcType="NUMERIC" 		javaType="Integer" />
		<parameter property="estado"      		jdbcType="VARCHAR" 		javaType="String" />
		<parameter property="responsable"      		jdbcType="VARCHAR" 		javaType="String" />
		<parameter property="CanalDeIngreso"     	jdbcType="VARCHAR"      	javaType="String" />
		
	</parameterMap>
	
	<parameterMap id="setModificaInversionProgramada" class="java.util.HashMap">
		<parameter property="numeroOperacion"     	jdbcType="NUMERIC"	    javaType="Integer"/>
		<parameter property="fechaCargo"      		jdbcType="DATE" 		javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler"/>
		<parameter property="frecuencia"      		jdbcType="NUMERIC" 		javaType="Integer" />
		<parameter property="monto"                 jdbcType="DOUBLE"		javaType="java.lang.Double" numericScale="8" />
		<parameter property="cuentaCargo"			jdbcType="CHAR"	    	javaType="String"/>
		<parameter property="estado"      			jdbcType="CHAR" 		javaType="String" />
		<parameter property="Responsable"        	jdbcType="VARCHAR"    	javaType="String" />
		<parameter property="CanalDeIngreso"     	jdbcType="VARCHAR"    	javaType="String" />
		<parameter property="autorizaInversion"    	jdbcType="CHAR"    	  	javaType="String" />
		
	</parameterMap>

	
	<resultMap id="getInversionProgramada" class="java.util.HashMap">
	        <result property="numeroOperacion"     		column="inv_id_programacion"	jdbcType="NUMERIC"    	javaType="Integer"/>
	        <result property="producto"     		column="fmu_nom_fondo"	 	jdbcType="VARCHAR"    	javaType="String"/>
	        <result property="tipoProducto"                 column="prd_cod_producto"	jdbcType="VARCHAR"    	javaType="String"/>
	        <result property="cuentaFondoMutuo"             column="fmu_num_cta"		jdbcType="VARCHAR"    	javaType="String"/>
	        <result property="fechaCargo"    		column="inv_fec_operacion"	jdbcType="DATE"    	javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler"  />      
	        <result property="frecuencia"		 	column="inv_frec_inversion"	jdbcType="VARCHAR"    	javaType="String"/>
		<result property="moneda"		 	column="fmu_moneda"		jdbcType="VARCHAR"    	javaType="String"/>
		<result property="monto"		 	column="fmu_mto_operacion"	jdbcType="DOUBLE"	javaType="java.lang.Double"/>
		<result property="cuentaCargo"		 	column="inv_cta_cte_cliente"	jdbcType="VARCHAR"    	javaType="String"/>
		<result property="estado"		 	column="inv_est_programacion"	jdbcType="VARCHAR"    	javaType="String"/>
		<result property="fechaCreacion"		column="inv_fec_creacion"	jdbcType="DATE"    	javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler"  />
		
		
	</resultMap>

	<resultMap id="getInversionProgramadaActiva" class="java.util.HashMap">
	        <result property="numeroOperacion"     		column="inv_id_programacion"	jdbcType="NUMERIC"    	javaType="Integer"/>
	        <result property="producto"     		column="fmu_nom_fondo"	 	jdbcType="VARCHAR"    	javaType="String"/>
	        <result property="tipoProducto"                 column="prd_cod_producto"	jdbcType="VARCHAR"    	javaType="String"/>
	        <result property="cuentaFondoMutuo"             column="fmu_num_cta"		jdbcType="NUMERIC"    	javaType="Integer"/>
	        <result property="fechaCargo"    		column="inv_fec_operacion"	jdbcType="DATE"    	javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler"  />      
	        <result property="frecuencia"		 	column="inv_frec_inversion"	jdbcType="NUMERIC"    	javaType="Integer"/>
		<result property="moneda"		 	column="fmu_moneda"		jdbcType="VARCHAR"    	javaType="String"/>
		<result property="monto"		 	column="fmu_mto_operacion"	jdbcType="DOUBLE"	javaType="java.lang.Double"/>
		<result property="cuentaCargo"		 	column="inv_cta_cte_cliente"	jdbcType="VARCHAR"    	javaType="String"/>
		<result property="estado"		 	column="inv_est_programacion"	jdbcType="VARCHAR"    	javaType="String"/>
		
	</resultMap>
	
	<parameterMap id="setDetalleInversionProgramada" class="java.util.HashMap">
		<parameter property="numeroOperacion"      	jdbcType="NUMERIC" 		javaType="Integer" />
	</parameterMap>
	<resultMap id="getInversionProgramadaActiva2" class="java.util.HashMap">
		        <result property="numeroOperacion"     		column="inv_id_programacion"	 	jdbcType="NUMERIC"    	javaType="Integer"/>
		        <result property="tipoProducto"                 column="prd_nom_producto"		jdbcType="VARCHAR"    	javaType="String"/>
		        <result property="producto"     		column="prd_cod_producto"	 	jdbcType="VARCHAR"    	javaType="String"/>
		        <result property="fechaCargo"    		column="inv_fec_operacion"		jdbcType="DATE"    	javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler"  />      
		        <result property="frecuencia"		 	column="inv_frec_inversion"		jdbcType="VARCHAR"    	javaType="String"/>
		        <result property="moneda"		 	column="fmu_moneda"			jdbcType="VARCHAR"    	javaType="String"/>
			<result property="monto"		 	column="fmu_mto_operacion"		jdbcType="DOUBLE"	javaType="java.lang.Double"/>
			<result property="cuentaFondoMutuo"             column="fmu_num_cta"			jdbcType="VARCHAR"    	javaType="String"/>
		        <result property="estado"		 	column="inv_est_programacion"		jdbcType="VARCHAR"    	javaType="String"/>
		        <result property="cuentaCargo"		 	column="inv_cta_cte_cliente"		jdbcType="VARCHAR"    	javaType="String"/>
			<result property="codigoFFMM"		 	column="fmu_cod_fondo"			jdbcType="NUMERIC"    	javaType="Integer"/>
	<result property="fechaIngreso"		column="inv_fec_hms_actualiza"		jdbcType="DATE"		javaType="java.util.Calendar" typeHandler="cl.bci.middleware.aplicacion.persistencia.handler.CalendarTypeHandler"  />
			<result property="ejecutivo"		 	column="inv_urs_cd_actualiza"		jdbcType="VARCHAR"    	javaType="String"/>
	</resultMap>
	
	<procedure id="muestraDetalleInversionesProgramadas" parameterMap="setDetalleInversionProgramada" resultMap="getInversionProgramadaActiva2">
		{ CALL sp_ConObtDetInvProg( ? ) }
	</procedure>

	<procedure id="consultaInversionesProgramadas" parameterMap="setInversionProgramada" resultMap="getInversionProgramada">
		{ CALL sp_ConInvProgAsoClie( ?, ? ) }
	</procedure>
	
	<procedure id="consultaInversionesProgramadasActivas" parameterMap="setInversionProgramada" resultMap="getInversionProgramadaActiva">
		{ CALL sp_ConInvProgActDet( ?, ? ) }
	</procedure>
	
	<procedure id="cambiaEstadoInversionesProgramadas" parameterMap="setCambiaEstadoInversionProgramada" resultClass="int">
		{ CALL sp_UpdCamEstinvProg( ?, ? ,?, ?) }
	</procedure>
	
	<procedure id="modificaInversionesProgramadas" parameterMap="setModificaInversionProgramada" resultClass="int" >
		{ CALL sp_UpdModDatInvProg( ?, ?, ?, ?, ?, ?, ? ,?, ?) }
	</procedure>
</sqlMap>
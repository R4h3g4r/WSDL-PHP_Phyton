<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="simubci.procedimientosAlmacenados">

<!-- INICIO RESULT MAPS -->
	<resultMap id="MapObtenerAtributos"	class="java.util.HashMap">
		<result property="codigo"				column="Codigo"/>
		<result property="descripcion"			column="Descripcion"/>
		<result property="indGracia"			column="IndGracia"/>
		<result property="cuotaGracia"			column="MaxGra"/>
		<result property="indExclusion"			column="IndExclu"/>
		<result property="indPrepago"			column="IndPrepago"/>
		<result property="indComple"			column="IndComplementario"/>
	</resultMap>

	<resultMap id="MapConsultarProductosHipotecarios"	class="java.util.HashMap">
		<result property="codigoError"			column="codErr" />
		<result property="descripcionError"		column="desErr" />
		<result property="codProducto"			column="codProducto" />
		<result property="producto"				column="desProducto" />
		<result property="minimaGracia"			column="minGracia" />
		<result property="maximaGracia"			column="maxGracia" />
		<result property="plazoMin"				column="minPlazo" />
		<result property="plazoMax"				column="maxPlazo" />
		<result property="diaPago"				column="diaVencimiento" />
		<result property="costoFondo"			column="costoFondo" />
		<result property="tasaSpread"			column="spread" />
		<result property="tasaAnual"			column="tasa" />
		<result property="tasaSegDesgrav"		column="factorSegDesg" />
		<result property="tasaSegIncendio"		column="tasaSeguroInc" />
		<result property="codigoMoneda"			column="codMoneda" />
		<result property="plazoMinimoConv"		column="plazoMinimoConv" />
		<result property="plazoMaximoConv"		column="plazoMaximoConv" />
	</resultMap>

	<resultMap id="MapObtenerProductoConComplementario"	class="java.util.HashMap">
		<result property="codErr"               column="codErr" />
		<result property="desErr"               column="desErr" />
		<result property="codProducto"          column="codProducto" />
		<result property="desProducto"          column="desProducto" />
		<result property="minGracia"            column="minGracia" />
		<result property="maxGracia"            column="maxGracia" />
		<result property="minPlazo"             column="minPlazo" />
		<result property="maxPlazo"             column="maxPlazo" />
		<result property="diaVencimiento"       column="diaVencimiento" />
		<result property="costoFondo"			column="costoFondo" />
		<result property="spread"			    column="spread" />
		<result property="tasa"			        column="tasa" />
		<result property="factorSegDesg"	    column="factorSegDesg" />
		<result property="tasaSeguroInc"	    column="tasaSeguroInc" />
		<result property="codMoneda"			column="codMoneda" />
	</resultMap>

	<resultMap id="MapObtenerProductoMixto"	class="java.util.HashMap">
		<result property="codErr"               column="codErr" />
		<result property="desErr"               column="desErr" />
		<result property="codProducto"          column="codProducto" />
		<result property="desProducto"          column="desProducto" />
		<result property="minGracia"            column="minGracia" />
		<result property="maxGracia"            column="maxGracia" />
		<result property="minPlazoTotal"        column="minPlazoTotal" />
		<result property="maxPlazoTotal"        column="maxPlazoTotal" />
		<result property="minPlazoMixto"        column="minPlazoMixto" />
		<result property="maxPlazoMixto"		column="maxPlazoMixto" />
		<result property="diaVencimiento"		column="diaVencimiento" />
		<result property="costoFondo"			column="costoFondo" />
		<result property="spread"		        column="spread" />
		<result property="tasa"		            column="tasa" />
		<result property="factorSegDesg"		column="factorSegDesg" />
		<result property="tasaSeguroInc"		column="tasaSeguroInc" />
		<result property="codMoneda"			column="codMoneda" />
	</resultMap>

	<resultMap id="MapCalcularSimulacionProyeccion"	class="java.util.HashMap">
		<result property="CodError"				column="CodError" />
		<result property="DescError"			column="DescError" />
		<result property="CuotaDesde"			column="CuotaDesde" />
		<result property="CuotaHasta"			column="CuotaHasta" />
		<result property="Tasa"					column="Tasa" />
		<result property="ValReducido"			column="ValReducido" />
		<result property="Dividendo"			column="Dividendo" />
		<result property="SegDesg"				column="SegDesg" />
		<result property="SegInc"				column="SegInc" />
		<result property="SegOtr"				column="SegOtr" />
		<!-- <result property="SegCesSub"			column="SegCesSub" /> -->
		<result property="DivTotal"				column="DivTotal" />
		<result property="DivTotalPe"			column="DivTotalPe" />
	</resultMap>

	<resultMap id="MapCalcularSimulacionIntranet"	class="java.util.HashMap">
		<result property="CodError"				column="CodError" />
		<result property="DescError"			column="DescError" />
		<result property="Plazo"				column="Plazo" />
		<result property="Tasa"					column="Tasa" />
		<result property="ValReducido"			column="ValReducido" />
		<result property="Dividendo"			column="Dividendo" />
		<result property="SegDesg"				column="SegDesg" />
		<result property="SegInc"				column="SegInc" />
		<result property="SegOtr"				column="SegOtr" />
		<!--<result property="SegCesSub"			column="SegCesSub" /> -->
		<result property="DivTotal"				column="DivTotal" />
		<result property="DivTotalPe"			column="DivTotalPe" />
	</resultMap>

	<resultMap id="MapCalcularSimulacionComplementaria"    class="java.util.HashMap">
		<result property="codError"        column="codError" />
		<result property="descError"       column="descError" />
		<result property="codProducto"     column="codProducto" />
		<result property="desProducto"     column="desProducto" />
		<result property="plazo"           column="plazo" />
		<result property="tasa"            column="tasa" />
		<result property="valReducido"     column="valReducido" />
		<result property="dividendo"       column="dividendo" />
		<result property="segDesg"         column="segDesg" />
		<result property="segInc"          column="segInc" />
		<result property="divTotal"        column="divTotal" />
		<result property="divTotalPe"      column="divTotalPe" />
	</resultMap>

	<resultMap id="MapCalcularSimulacionMixto"    class="java.util.HashMap">
		<result property="CodError"        column="codError" />
		<result property="DescError"       column="descError" />
		<result property="codProducto"     column="codProducto" />
		<result property="DesProducto"     column="desProducto" />
		<result property="Plazo"           column="plazo" />
		<result property="Tasa"            column="tasa" />
		<result property="ValReducido"     column="valReducido" />
		<result property="Dividendo"       column="dividendo" />
		<result property="SegDesg"         column="segDesg" />
		<result property="SegInc"          column="segInc" />
		<result property="DivTotal"        column="divTotal" />
		<result property="DivTotalPe"      column="divTotalPe" />
	</resultMap>

	<resultMap id="MapObtenerPlazos"	class="java.util.HashMap">
		<result property="codigoError"			column="CodErr" />
		<result property="descripcionError"		column="DesErr" />
		<result property="codProducto"			column="CodPro" />
		<result property="objetivo"				column="CodObj" />
		<result property="plazo"				column="PlzAno" />
	</resultMap>

	<resultMap id="MapObtenerDiasVencimiento"	class="java.util.HashMap">
		<result property="codigoError"		column="CodError" />
		<result property="descripcionError"	column="DescError" />
		<result property="fecVencimiento"	column="DiaVen" />
	</resultMap>

	<resultMap id="MapObtenerSegurosVinculados"	class="java.util.HashMap">
		<result property="codigoError"			column="CodError" />
		<result property="descripcionError"		column="DescError" />
		<result property="codigoSeguro"         column="tipseg"/>
		<result property="nombreSeguro"			column="desSeguro" />
		<result property="montoUF"				column="primaMensualUF" />
		<result property="montoPesos"			column="primaMensualPe" />
	</resultMap>

	<resultMap id="MapObtenerGastosOperacionales"	class="java.util.HashMap">
		<result property="codigoError"		column="CodError" />
		<result property="descripcionError"	column="DescErr" />
		<result property="Tasacion"			column="Tasacion" />
		<result property="EstTitulo"		column="EstTitulo" />
		<result property="Borrador"			column="Borrador" />
		<result property="Notaria"			column="Notaria" />
		<result property="Mutuo"			column="Mutuo" />
		<result property="Cbr"				column="Cbr" />
	</resultMap>

<!-- INICIO PROCEDIMIENTOS -->

	<!-- C2010_traeCodigos -->
	<procedure id="obtenerAtributos" parameterClass="java.util.HashMap" resultMap="MapObtenerAtributos">
			{CALL C2010_traeCodigos(
				#tabla#,
				<isNull property="canal">NULL</isNull> <isNotNull property="canal">#canal#</isNotNull>
			)}
	</procedure>

	<!-- C2010_DetProductos -->
	<procedure id="consultarProductosHipotecarios" parameterClass="java.util.HashMap" resultMap="MapConsultarProductosHipotecarios">
			{CALL C2010_DetProductos(
				#areaEjecutivo#,
				#objetivo#,
				#tipoVivienda#,
				#destino#,
				#antiguedad#,
				#seguroIncendio#,
				#mesNoPago#,
				#indDfl2#,
				#valor#,
				#montoCredito#,
				#monto#,
				<isNull property="pacContratado">NULL</isNull> <isNotNull property="pacContratado">#pacContratado#</isNotNull>,
				<isNull property="codigoMoneda">NULL</isNull> <isNotNull property="codigoMoneda">#codigoMoneda#</isNotNull>,
				<isNull property="costoPrepago">NULL</isNull> <isNotNull property="costoPrepago">#costoPrepago#</isNotNull>,
				#plazo#
			)}
	</procedure>

	<!-- C2010_CalcSimulaProy -->
	<procedure id="calcularSimulacionProyeccion" parameterClass="java.util.HashMap" resultMap="MapCalcularSimulacionProyeccion">
			{CALL C2010_CalcSimulaProy(
				#TipFinancia#,
				#CodProducto#,
				#CodObjetivo#,
				<isNull property="CodMoneda">NULL</isNull> <isNotNull property="CodMoneda">#CodMoneda#</isNotNull>,
				#CodTipBien#,
				#CodDfl2#,
				<isNull property="CodAnt">NULL</isNull> <isNotNull property="CodAnt">#CodAnt#</isNotNull>,
				#CodMesExc#,
				#CantMesGr#,
				#CodIndPrep#,
				#DiaVenc#,
				#FechaCalc#,
				<isNull property="ValPropiedad">NULL</isNull> <isNotNull property="ValPropiedad">#ValPropiedad#</isNotNull>,
				#ValCredito#,
				<isNull property="CodIndPac">NULL</isNull> <isNotNull property="CodIndPac">#CodIndPac#</isNotNull>,
				#CodSeguro#,
				<isNull property="TasCom">NULL</isNull> <isNotNull property="TasCom">#TasCom#</isNotNull>,
				<isNull property="TasBas">NULL</isNull> <isNotNull property="TasBas">#TasBas#</isNotNull>,
				<isNull property="TasSegInc">NULL</isNull> <isNotNull property="TasSegInc">#TasSegInc#</isNotNull>,
				<isNull property="TasSegDes">NULL</isNull> <isNotNull property="TasSegDes">#TasSegDes#</isNotNull>,
				<isNull property="PlaCre">NULL</isNull> <isNotNull property="PlaCre">#PlaCre#</isNotNull>,
				<isNull property="indEnfGraves">NULL</isNull> <isNotNull property="indEnfGraves">#indEnfGraves#</isNotNull>,
				<isNull property="indHosp">NULL</isNull> <isNotNull property="indHosp">#indHosp#</isNotNull>,
				<isNull property="indCesantia">NULL</isNull> <isNotNull property="indCesantia">#indCesantia#</isNotNull>,
				<isNull property="indHogarCont">NULL</isNull> <isNotNull property="indHogarCont">#indHogarCont#</isNotNull>,
				<isNull property="montoContenido">NULL</isNull> <isNotNull property="montoContenido">#montoContenido#</isNotNull>,
				#Indsubsidio#
			)}
	</procedure>

	<!-- C2010_calcSimulaINtra -->
	<procedure id="calcularSimulacionIntranet" parameterClass="java.util.HashMap" resultMap="MapCalcularSimulacionIntranet">
			{CALL C2010_calcSimulaINtra(
				#TipFinancia#,
				#CodProducto#,
				#CodObjetivo#,
				#CodMoneda#,
				#CodTipBien#,
				#CodDfl2#,
				#CodAnt#,
				#CodMesExc#,
				#CantMesGr#,
				#CodIndPrep#,
				#DiaVenc#,
				#FechaCalc#,
				#ValPropiedad#,
				#ValCredito#,
				#CodIndPac#,
				#CodSeguro#,
				<isNull property="TasCom">NULL</isNull> <isNotNull property="TasCom">#TasCom#</isNotNull>,
				<isNull property="TasBas">NULL</isNull> <isNotNull property="TasBas">#TasBas#</isNotNull>,
				<isNull property="TasSegInc">NULL</isNull> <isNotNull property="TasSegInc">#TasSegInc#</isNotNull>,
				<isNull property="TasSegDes">NULL</isNull> <isNotNull property="TasSegDes">#TasSegDes#</isNotNull>,
				<isNull property="PlaCre">NULL</isNull> <isNotNull property="PlaCre">#PlaCre#</isNotNull>,
				<isNull property="indEnfGraves">NULL</isNull> <isNotNull property="indEnfGraves">#indEnfGraves#</isNotNull>,
				<isNull property="indHosp">NULL</isNull> <isNotNull property="indHosp">#indHosp#</isNotNull>,
				<isNull property="indCesantia">NULL</isNull> <isNotNull property="indCesantia">#indCesantia#</isNotNull>,
				<isNull property="indHogarCont">NULL</isNull> <isNotNull property="indHogarCont">#indHogarCont#</isNotNull>,
				<isNull property="montoContenido">NULL</isNull> <isNotNull property="montoContenido">#montoContenido#</isNotNull>,
				<isNull property="plazoConv">NULL</isNull> <isNotNull property="plazoConv">#plazoConv#</isNotNull>,
				#Indsubsidio#
			)}
	</procedure>

	<!-- Chip_CalcMixto -->
	<procedure id="calcularSimulacionMixto" parameterClass="java.util.HashMap" resultMap="MapCalcularSimulacionMixto">
			{CALL Chip_CalcMixto(
				#CodProducto#,
				#CodObjetivo#,
				#CodMoneda#,
				#CodTipBien#,
				#CodDfl2#,
				#CodAnt#,
				#CodMesExc#,
				#CantMesGr#,
				#CodIndPrep#,
				#DiaVenc#,
				#FechaCalc#,
				#ValPropiedad#,
				#ValCredito#,
				#CodIndPac#,
				#CodSeguro#,
				#TasSprPri#,
				#TasSprSeg#,
				#TasCfoPri#,
				#TasCfoSeg#,
				#TasSegInc#,
				#TasSegDes#,
				#PlaCrePri#,
				#PlaCreSeg#
			)}
	</procedure>

	<!-- Chip_CalcComple -->
	<procedure id="calcularSimulacionComplementaria" parameterClass="java.util.HashMap" resultMap="MapCalcularSimulacionComplementaria">
			{CALL Chip_CalcComple(
				#CodObjetivo#,
				#CodMoneda#,
				#CodTipBien#,
				#CodDfl2#,
				#CodAnt#,
				#CodMesExc#,
				#CantMesGr#,
				#CodIndPrep#,
				#DiaVenc#,
				#FechaCalc#,
				#ValPropiedad#,
				#ValCredito#,
				#CodIndPac#,
				#CodSeguro#,
				#CodProdCom#,
				#TasComLetra#,
				#TasBasLetra#,
				#TasSegIncLetra#,
				#TasSegDes#,
				#TasSprCom#,
				#TasCfoCom#,
				#TasSegIncCom#,
				#TasSegDesCom#,
				#PlaCreLetras#,
				#PlaCreCom#
			)}
	</procedure>

	<!-- Chip_DetalleMixto -->
	<procedure id="obtenerProductoMixto" parameterClass="java.util.HashMap" resultMap="MapObtenerProductoMixto">
			{CALL Chip_DetalleMixto(
				#objetivo#,
				#tipoVivienda#,
				#destino#,
				#antiguedad#,
				#codSeguroInc#,
				#mesNoPago#,
				#indDFL2#,
				#montoPropiedad#,
				#montoCredito#,
				#montoPie#,
				#Plazo#
			)}
	</procedure>

	<!-- Chip_DetalleComple -->
	<procedure id="obtenerProductoConComplementario" parameterClass="java.util.HashMap" resultMap="MapObtenerProductoConComplementario">
			{CALL Chip_DetalleComple(
				#objetivo#,
				#tipoVivienda#,
				#destino#,
				#antiguedad#,
				#codSeguroInc#,
				#mesNoPago#,
				#indDFL2#,
				#montoPropiedad#,
				#montoCredito#,
				#montoPie#,
				#Plazo#
			)}
	</procedure>

	<!-- C2010_DetaPlazos -->
	<procedure id="obtenerPlazos" parameterClass="java.util.HashMap" resultMap="MapObtenerPlazos">
			{CALL C2010_DetaPlazos(
				<isNull property="codProducto">NULL</isNull> <isNotNull property="codProducto">#codProducto#</isNotNull>
			)}
	</procedure>

	<!-- C2010_ProductoVen -->
	<procedure id="obtenerDiasVencimiento" parameterClass="java.util.HashMap" resultMap="MapObtenerDiasVencimiento">
			{CALL C2010_ProductoVen(
				#codProducto#
			)}
	</procedure>

	<!-- C2010_DetalleSegurosVinc -->
	<procedure id="obtenerSegurosVinculados" parameterClass="java.util.HashMap" resultMap="MapObtenerSegurosVinculados">
			{CALL C2010_DetalleSegurosVinc(
				#codProducto#,
				#valorTotal#,
				#montoCredito#
			)}
	</procedure>

	<!-- C2010_GtoOperacional -->
	<procedure id="obtenerGastosOperacionales" parameterClass="java.util.HashMap" resultMap="MapObtenerGastosOperacionales">
			{CALL C2010_GtoOperacional(
				#indDfl2#,
				#valorTotal#,
				#montoCredito#,
				#antiguedad#
			)}
	</procedure>

</sqlMap>

<?xml version="1.0" encoding="UTF-8" ?>    

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
    
<sqlMap namespace="ctl.procedimientosAlmacenados">
    <resultMap id="getObtenerRecomendaciones" class="java.util.HashMap">
		<result property="rec_cod"   		column="rec_cod"   	    javaType="java.lang.Integer"/>
		<result property="rec_fec_ini"  	column="rec_fec_ini"  	javaType="java.util.Date"   />
		<result property="rec_fec_fin"  	column="rec_fec_fin"  	javaType="java.util.Date"   />
		<result property="rec_cod_est"  	column="rec_cod_est"  	javaType="java.lang.String" />
		<result property="rec_desc"     	column="rec_desc"     	javaType="java.lang.String" />
		<result property="rec_txt"     		column="rec_txt"     	javaType="java.lang.String" />
		<result property="rec_fil_cpt_1"	column="rec_fil_cpt_1"	javaType="java.lang.String" />
		<result property="rec_fil_vlr_1"	column="rec_fil_vlr_1"	javaType="java.lang.String" />
		<result property="rec_fil_cpt_2"	column="rec_fil_cpt_2"	javaType="java.lang.String" />
		<result property="rec_fil_vlr_2"	column="rec_fil_vlr_2"	javaType="java.lang.String" />
		<result property="rec_fil_cpt_3"	column="rec_fil_cpt_3"	javaType="java.lang.String" />
		<result property="rec_fil_vlr_3"	column="rec_fil_vlr_3"	javaType="java.lang.String" />
		<result property="rec_fil_cpt_4"	column="rec_fil_cpt_4"	javaType="java.lang.String" />
		<result property="rec_fil_vlr_4"	column="rec_fil_vlr_4"	javaType="java.lang.String" />
    </resultMap>
    <procedure id="obtenerRecomendaciones"   resultMap="getObtenerRecomendaciones">
        { CALL sp_cns_rec }
    </procedure>
	
    <parameterMap id="setObtenerRecomendacion" class="java.util.HashMap">
        <parameter property="rec_cod"   jdbcType="INTEGER"       javaType="java.lang.Integer"/>
    </parameterMap>
    <resultMap id="getObtenerRecomendacion" class="java.util.HashMap">
		<result property="rec_cod"   		column="rec_cod"   	    javaType="java.lang.Integer"/>
		<result property="rec_fec_ini"  	column="rec_fec_ini"  	javaType="java.util.Date"   />
		<result property="rec_fec_fin"  	column="rec_fec_fin"  	javaType="java.util.Date"   />
		<result property="rec_cod_est"  	column="rec_cod_est"  	javaType="java.lang.String" />
		<result property="rec_desc"     	column="rec_desc"     	javaType="java.lang.String" />
		<result property="rec_txt"     		column="rec_txt"     	javaType="java.lang.String" />
		<result property="rec_fil_cpt_1"	column="rec_fil_cpt_1"	javaType="java.lang.String" />
		<result property="rec_fil_vlr_1"	column="rec_fil_vlr_1"	javaType="java.lang.String" />
		<result property="rec_fil_cpt_2"	column="rec_fil_cpt_2"	javaType="java.lang.String" />
		<result property="rec_fil_vlr_2"	column="rec_fil_vlr_2"	javaType="java.lang.String" />
		<result property="rec_fil_cpt_3"	column="rec_fil_cpt_3"	javaType="java.lang.String" />
		<result property="rec_fil_vlr_3"	column="rec_fil_vlr_3"	javaType="java.lang.String" />
		<result property="rec_fil_cpt_4"	column="rec_fil_cpt_4"	javaType="java.lang.String" />
		<result property="rec_fil_vlr_4"	column="rec_fil_vlr_4"	javaType="java.lang.String" />
    </resultMap>
    <procedure id="obtenerRecomendacion" parameterMap="setObtenerRecomendacion" resultMap="getObtenerRecomendacion">
        { CALL sp_cns_det_rec ( ? ) }
    </procedure>
	
    <parameterMap id="setRecomendacion" class="java.util.HashMap">
		<parameter property="rec_fec_ini"  	jdbcType="DATE" javaType="java.util.Date"   />
		<parameter property="rec_fec_fin"  	jdbcType="DATE" javaType="java.util.Date"   />
		<parameter property="rec_cod_est"  	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_desc"     	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_txt"     	jdbcType="VARCHAR" javaType="java.lang.String" />
		<parameter property="rec_fil_cpt_1"	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_fil_vlr_1"	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_fil_cpt_2"	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_fil_vlr_2"	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_fil_cpt_3"	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_fil_vlr_3"	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_fil_cpt_4"	jdbcType="CHAR" javaType="java.lang.String" />
		<parameter property="rec_fil_vlr_4"	jdbcType="CHAR" javaType="java.lang.String" />
    </parameterMap>
    <procedure id="grabarRecomendacion" parameterMap="setRecomendacion" resultClass="Integer" >
        { CALL sp_ins_rec ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) }
    </procedure>
	
    <parameterMap id="setModificarRecomendacion" class="java.util.HashMap">
	    <parameter property="rec_cod"  	    jdbcType="INTEGER"  javaType="Integer" />
		<parameter property="rec_fec_ini"  	jdbcType="DATETIME" javaType="Date"   />
		<parameter property="rec_fec_fin"  	jdbcType="DATETIME" javaType="Date"   />
		<parameter property="rec_cod_est"  	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_desc"     	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_txt"     	jdbcType="VARCHAR"  javaType="String" />
		<parameter property="rec_fil_cpt_1"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_fil_vlr_1"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_fil_cpt_2"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_fil_vlr_2"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_fil_cpt_3"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_fil_vlr_3"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_fil_cpt_4"	jdbcType="CHAR" 	javaType="String" />
		<parameter property="rec_fil_vlr_4"	jdbcType="CHAR"     javaType="String" />
    </parameterMap>
    <procedure id="modificarRecomendacion" parameterMap="setModificarRecomendacion" resultClass="Integer" >
        { CALL sp_mod_rec ( ? , ? , ? , ? ,? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) }
    </procedure>	
	
	<resultMap id="getObtenerTextoRecomendacionPorDefecto" class="java.util.HashMap">
        <result property="rec_txt_dft"  column="rec_txt_dft"   javaType="java.lang.String"/>
    </resultMap>
    <procedure id="obtenerTextoRecomendacionPorDefecto"  resultMap="getObtenerTextoRecomendacionPorDefecto" >
        { CALL sp_cns_rec_txt_dft }
    </procedure>	

	
    <resultMap id="getObtenerImagenPorDefectoBanner" class="java.util.HashMap">
        <result property="ban_img_dft"  column="ban_img_dft"   javaType="java.lang.String"/>
    </resultMap>
    <procedure id="obtenerImagenPorDefectoBanner" resultMap="getObtenerImagenPorDefectoBanner">
        { CALL sp_cns_ban_img_dft }
    </procedure>	
	
    <resultMap id="getObtenerBanners" class="java.util.HashMap">
        <result property="ban_cod"         column="ban_cod"         javaType="Integer"/>
        <result property="ban_fec_ini"     column="ban_fec_ini"     javaType="Date"   />
        <result property="ban_fec_fin"     column="ban_fec_fin"     javaType="Date"   />
        <result property="ban_cod_est"     column="ban_cod_est"     javaType="String" />
		<result property="ban_desc"        column="ban_desc"        javaType="String" />
		<result property="ban_img"         column="ban_img"         javaType="String" />
        <result property="ban_fil_cpt_1"   column="ban_fil_cpt_1"   javaType="String" />
        <result property="ban_fil_vlr_1"   column="ban_fil_vlr_1"   javaType="String" />
        <result property="ban_fil_cpt_2"   column="ban_fil_cpt_2"   javaType="String" />
        <result property="ban_fil_vlr_2"   column="ban_fil_vlr_2"   javaType="String" />
        <result property="ban_fil_cpt_3"   column="ban_fil_cpt_3"   javaType="String" />
        <result property="ban_fil_vlr_3"   column="ban_fil_vlr_3"   javaType="String" />
        <result property="ban_fil_cpt_4"   column="ban_fil_cpt_4"   javaType="String" />
        <result property="ban_fil_vlr_4"   column="ban_fil_vlr_4"   javaType="String" />
        <result property="ban_fil_cpt_5"   column="ban_fil_cpt_5"   javaType="String" />
        <result property="ban_fil_vlr_5"   column="ban_fil_vlr_5"   javaType="String" />
    </resultMap>
    <procedure id="obtenerBanners" resultMap="getObtenerBanners">
        { CALL sp_cns_ban }
    </procedure> 

    <parameterMap id="setObtenerBanner" class="java.util.HashMap">
        <parameter property="ban_cod"          jdbcType="INTEGER"       javaType="java.lang.Integer"/>
    </parameterMap>
    <resultMap id="getObtenerBanner" class="java.util.HashMap">
        <result property="ban_cod"         column="ban_cod"         javaType="Integer"/>
        <result property="ban_fec_ini"     column="ban_fec_ini"     javaType="Date"   />
        <result property="ban_fec_fin"     column="ban_fec_fin"     javaType="Date"   />
        <result property="ban_cod_est"     column="ban_cod_est"     javaType="String" />
		<result property="ban_desc"        column="ban_desc"        javaType="String" />
		<result property="ban_img"         column="ban_img"         javaType="String" />
        <result property="ban_fil_cpt_1"   column="ban_fil_cpt_1"   javaType="String" />
        <result property="ban_fil_vlr_1"   column="ban_fil_vlr_1"   javaType="String" />
        <result property="ban_fil_cpt_2"   column="ban_fil_cpt_2"   javaType="String" />
        <result property="ban_fil_vlr_2"   column="ban_fil_vlr_2"   javaType="String" />
        <result property="ban_fil_cpt_3"   column="ban_fil_cpt_3"   javaType="String" />
        <result property="ban_fil_vlr_3"   column="ban_fil_vlr_3"   javaType="String" />
        <result property="ban_fil_cpt_4"   column="ban_fil_cpt_4"   javaType="String" />
        <result property="ban_fil_vlr_4"   column="ban_fil_vlr_4"   javaType="String" />
        <result property="ban_fil_cpt_5"   column="ban_fil_cpt_5"   javaType="String" />
        <result property="ban_fil_vlr_5"   column="ban_fil_vlr_5"   javaType="String" />
    </resultMap>
    <procedure id="obtenerBanner" parameterMap="setObtenerBanner" resultMap="getObtenerBanner">
        { CALL sp_cns_det_ban ( ? ) }
    </procedure>

    <parameterMap id="setGrabarBanner" class="java.util.HashMap">
		<parameter property="ban_fec_ini"  	jdbcType="DATETIME" 	javaType="Date"   />
		<parameter property="ban_fec_fin"  	jdbcType="DATETIME" 	javaType="Date"   />
		<parameter property="ban_cod_est"  	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_desc"     	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_img"     	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_cpt_1"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_vlr_1"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_cpt_2"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_vlr_2"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_cpt_3"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_vlr_3"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_cpt_4"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_vlr_4"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_cpt_5"	jdbcType="CHAR"     	javaType="String" />
		<parameter property="ban_fil_vlr_5"	jdbcType="CHAR"     	javaType="String" />
    </parameterMap>
    <procedure id="grabarBanner" parameterMap="setGrabarBanner" resultClass="Integer">
        { CALL sp_ins_ban ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? ) }
    </procedure> 


    <parameterMap id="setModificarBanner" class="java.util.HashMap">
		<parameter property="ban_cod"       jdbcType="INTEGER"       javaType="Integer"/>	
		<parameter property="ban_fec_ini"  	jdbcType="DATETIME"      javaType="Date"   />
		<parameter property="ban_fec_fin"  	jdbcType="DATETIME"      javaType="Date"   />
		<parameter property="ban_cod_est"  	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_desc"     	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_img"     	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_cpt_1"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_vlr_1"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_cpt_2"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_vlr_2"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_cpt_3"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_vlr_3"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_cpt_4"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_vlr_4"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_cpt_5"	jdbcType="CHAR"     	 javaType="String" />
		<parameter property="ban_fil_vlr_5"	jdbcType="CHAR"     	 javaType="String" />
    </parameterMap>
    <procedure id="modificarBanner" parameterMap="setModificarBanner" resultClass="Integer">
        { CALL sp_mod_ban ( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ?  ) }
    </procedure> 
	
	<parameterMap id="setModificarTextoRecomendacionPorDefecto" class="java.util.HashMap">
        <parameter property="rec_txt_dft"            jdbcType="VARCHAR"       javaType="java.lang.String"/>
    </parameterMap>
    <procedure id="modificarTextoRecomendacionPorDefecto" parameterMap="setModificarTextoRecomendacionPorDefecto" resultClass="Integer">
        { CALL sp_mod_rec_txt_dft ( ? ) }
    </procedure> 
	
    <parameterMap id="setModificarImagenPorDefectoBanner" class="java.util.HashMap">
        <parameter property="ban_img_dft"            jdbcType="STRING"       javaType="java.lang.String"/>
    </parameterMap>
    <procedure id="modificarImagenPorDefectoBanner" parameterMap="setModificarImagenPorDefectoBanner" resultClass="Integer">
        { CALL sp_mod_ban_img_dft ( ? ) }
    </procedure>

	<procedure id="obtenerFoliosLineaSobregiroHistorica"  parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
      {CALL sp_cns_fol_ls_his(#numeroCuenta#, #anyo#)}
    </procedure>
    
    <select id="obtenerCartolaLineaSobregiroHistorica" remapResults="true" resultClass="java.util.HashMap" parameterClass="java.util.Map">
        SELECT num_cct, num_fol, fec_mov, det_ctl, fec_prc FROM LSG_$sufijoTabla$ 
            WHERE num_cct=#numeroCuenta# AND 
                  num_fol=#numeroFolio#
    </select>
    <!-- OBTENER IMAGEN CARTOLA -->
    <resultMap id="getObtenerImagenCartola" class="java.util.HashMap">
		<result property="imagen" column="det_ctl" />
	<result property="fechaProceso" column="fec_prc" />
	</resultMap>

	<parameterMap id="setObtenerImagenCartola" class="java.util.HashMap">
		<parameter property="nroCuenta"  	jdbcType="VARCHAR" javaType="String" />
		<parameter property="folio"   		jdbcType="VARCHAR" javaType="String" />
		<parameter property="ano"   		jdbcType="VARCHAR" javaType="String" />
	</parameterMap>		

	<procedure id="obtenerImagenCartola" parameterMap="setObtenerImagenCartola" resultMap="getObtenerImagenCartola">
		{ CALL sp_cns_img_cartola( ?, ?, ? ) }
	</procedure>
	
	<!-- OBTENER CARTOLAS LISTADO -->
	<resultMap id="getObtenerCartolasHistoricas" class="java.util.HashMap">
		<result property="idSolicitud" column="Tmp_Sol_Id" />
		<result property="numFolio" column="Tmp_Num_Folio" />
		<result property="fecMovimiento" column="Tmp_Fec_Mov" />
		<result property="estado" column="Tmp_Ind_Estado" />
		<result property="nombreArchivo" column="Tmp_Nom_Archivo" />
		<result property="nombreCartola" column="Tmp_Nom_Cartola" />
	</resultMap>

	<parameterMap id="setObtenerCartolasHistoricas" class="java.util.HashMap">
		<parameter property="nroCuenta"  	jdbcType="VARCHAR" javaType="String" />
		<parameter property="fechaDesde"   	jdbcType="DATETIME" javaType="Date" />
		<parameter property="fechaHasta"   	jdbcType="DATETIME" javaType="Date" />
	</parameterMap>		

	<procedure id="obtenerCartolasHistoricas" parameterMap="setObtenerCartolasHistoricas" resultMap="getObtenerCartolasHistoricas">
		{ CALL sp_cns_cartola( ?, ?, ? ) }
	</procedure>
	
	<!-- INSERTAR SOLICITUD -->
	<parameterMap id="setInsertarSolicitudCartola" class="java.util.HashMap">
		<parameter property="idSolicitud"  		jdbcType="INTEGER" 	javaType="Integer" />
		<parameter property="nroCuenta"  		jdbcType="CHAR" 	javaType="String" />
		<parameter property="nomEjecutivo"   	jdbcType="CHAR" 	javaType="String" />
		<parameter property="fecDesde"   		jdbcType="DATETIME" javaType="Date" />
		<parameter property="fecHasta"   		jdbcType="DATETIME"	javaType="Date" />
		<parameter property="numCanal"   		jdbcType="CHAR" 	javaType="String" />
		<parameter property="indTipoCartola"   	jdbcType="INTEGER" 	javaType="Integer" />
		<parameter property="indAgrupar"   		jdbcType="CHAR" 	javaType="String" />
		<parameter property="indEstado"   		jdbcType="CHAR" 	javaType="String" />
		<parameter property="fecSolicitud"   	jdbcType="DATETIME" javaType="Date" />
		<parameter property="desObservacion"   	jdbcType="VARCHAR" 	javaType="String" />
		<parameter property="arrFolio"   		jdbcType="VARCHAR" 	javaType="String" />
		<parameter property="arrFechasMov"   	jdbcType="VARCHAR" 	javaType="String" />
	</parameterMap>	
	
	<resultMap class="java.util.HashMap" id="getInsertaSolicitudCartola">
		<result property="idSolicitud" jdbcType="INTEGER" 	javaType="String"/>
	</resultMap>	

	<procedure id="insertarSolicitudCartola" parameterMap="setInsertarSolicitudCartola" resultMap="getInsertaSolicitudCartola">
		{ CALL sp_ing_solicitud( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? ) }
	</procedure>
    
    <parameterMap id="setActualizarSolicitudCartola" class="java.util.HashMap">
		<parameter property="idSolicitud"  		jdbcType="INTEGER" 	javaType="Integer" />
		<parameter property="estado"		   	jdbcType="CHAR" 	javaType="String" />
		<parameter property="nombreArchivo"	 	jdbcType="VARCHAR" 	javaType="String" />
		
	</parameterMap>		

	<procedure id="actualizaSolicitudCartola" parameterMap="setActualizarSolicitudCartola" resultClass="java.util.HashMap">
		{ CALL sp_act_solicitud( ?, ?, ? ) }
	</procedure> 	


	<parameterMap id="setGrabarErrorSolicitud" class="java.util.HashMap">
		<parameter property="errFecGeneracion"  jdbcType="DATETIME" javaType="Date" />
		<parameter property="errIdSolicitud"	jdbcType="INTEGER" 	javaType="Integer" />
		<parameter property="errUsuGenerador"	jdbcType="VARCHAR" 	javaType="String" />
		<parameter property="errTxtException"	jdbcType="VARCHAR" 	javaType="String" />
	</parameterMap>

	<procedure id="grabarErrorSolicitud" parameterMap="setGrabarErrorSolicitud" resultClass="java.util.HashMap">
		{ CALL sp_ins_err_sol( ?, ?, ?, ? ) }
	</procedure> 	


</sqlMap>
